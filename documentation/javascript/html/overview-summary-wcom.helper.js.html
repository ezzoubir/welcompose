<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
Welcompose<sup><small>TM</small></sup> Javascript API Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="wcom.helper.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="middle">
<b>Welcompose<sup><small>TM</small></sup> Javascript API</b>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>wcom.helper.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Comprised javascript helper functions.
 It contains functions that may be used application wide.<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="Helper.html">Helper</a></b></td>
    <td>The Helper class defines a bunch of functions which doesn't 
 belongs as regards content to just one class.</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/**
 * Project: Welcompose
 * File: wcom.helper.js
 *
 * Copyright (c) 2008 creatics
 *
 * Project owner:
 * creatics, Olaf Gleba
 * 50939 KÃ¶ln, Germany
 * http://www.creatics.de
 *
 * This file is licensed under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE v3
 * http://www.opensource.org/licenses/agpl-v3.html
 *
 * $Id: wcom.helper.js 1211 2008-11-01 09:28:01Z og<span class="attrib">@creatics</span>.de $
 *
 * <span class="attrib">@copyright</span> 2008 creatics, Olaf Gleba
 * <span class="attrib">@author</span> Olaf Gleba
 * <span class="attrib">@package</span> Welcompose
 * <span class="attrib">@license</span> http://www.opensource.org/licenses/agpl-v3.html GNU AFFERO GENERAL PUBLIC LICENSE v3
 */</span>

<span class="comment">/** 
 * <span class="attrib">@fileoverview</span> Comprised javascript helper functions.
 * It contains functions that may be used application wide.
 *
 */</span>


<span class="comment">/**
 * Constructs the Helper class
 * 
 * <span class="attrib">@class</span> The Helper class defines a bunch of functions which doesn't 
 * belongs as regards content to just one class. Several functions be in use
 * within every Welcompose class. The scope is application wide.
 *
 * <span class="attrib">@constructor</span>
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper ()
{
	try {
		<span class="comment">// no properties		</span>
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/* Inherit from Base */</span>
Helper.<span class="reserved">prototype</span> = new Base();


<span class="comment">/**
 * Instance Methods from prototype <span class="attrib">@class</span> Helper
 */</span>
Helper.<span class="reserved">prototype</span>.launchPopup = Helper_launchPopup;

Helper.<span class="reserved">prototype</span>.getTextConverterValue = Helper_getTextConverterValue;
Helper.<span class="reserved">prototype</span>.getSelectionText = Helper_getSelectionText;
Helper.<span class="reserved">prototype</span>.getDelimiterValue = Helper_getDelimiterValue;
Helper.<span class="reserved">prototype</span>.getPagerPage = Helper_getPagerPage;
Helper.<span class="reserved">prototype</span>.getInsertType = Helper_getInsertType;
Helper.<span class="reserved">prototype</span>.closePopup = Helper_closePopup;
Helper.<span class="reserved">prototype</span>.closeLinksPopup = Helper_closeLinksPopup;
Helper.<span class="reserved">prototype</span>.closePopupTrack = Helper_closePopupTrack;
Helper.<span class="reserved">prototype</span>.closePopupTrackNoAlert = Helper_closePopupTrackNoAlert;
Helper.<span class="reserved">prototype</span>.lowerOpacity = Helper_lowerOpacity;
Helper.<span class="reserved">prototype</span>.lowerOpacityOnUpload = Helper_lowerOpacityOnUpload;
Helper.<span class="reserved">prototype</span>.isBrowser = Helper_isBrowser;
Helper.<span class="reserved">prototype</span>.defineWindowX = Helper_defineWindowX;
Helper.<span class="reserved">prototype</span>.defineWindowY = Helper_defineWindowY;
Helper.<span class="reserved">prototype</span>.definePageY = Helper_definePageY;
Helper.<span class="reserved">prototype</span>.showNextNode = Helper_showNextNode;
Helper.<span class="reserved">prototype</span>.showNextNodeBoxes = Helper_showNextNodeBoxes;
Helper.<span class="reserved">prototype</span>.loaderPagesLinks = Helper_loaderPagesLinks;
Helper.<span class="reserved">prototype</span>.showResponsePagesSecondLinks = Helper_showResponsePagesSecondLinks;
Helper.<span class="reserved">prototype</span>.showResponsePagesThirdLinks = Helper_showResponsePagesThirdLinks;
Helper.<span class="reserved">prototype</span>.insertTagsCallbacks = Helper_insertTagsCallbacks;
Helper.<span class="reserved">prototype</span>.insertTagsFromPopupCallbacks = Helper_insertTagsFromPopupCallbacks;
Helper.<span class="reserved">prototype</span>.processCallbacks = Helper_processCallbacks;
Helper.<span class="reserved">prototype</span>.showResponseProcessCallbacks = Helper_showResponseProcessCallbacks;
Helper.<span class="reserved">prototype</span>.callbacksInsert = Helper_callbacksInsert;
Helper.<span class="reserved">prototype</span>.changeBlogCommentStatus = Helper_changeBlogCommentStatus;
Helper.<span class="reserved">prototype</span>.loaderChangeBlogCommentStatus = Helper_loaderChangeBlogCommentStatus;
Helper.<span class="reserved">prototype</span>.showResponseChangeBlogCommentStatus = Helper_showResponseChangeBlogCommentStatus;
Helper.<span class="reserved">prototype</span>.showFileUploadMessage = Helper_showFileUploadMessage;
Helper.<span class="reserved">prototype</span>.validate = Helper_validate;
Helper.<span class="reserved">prototype</span>.confirmDelNavAction = Helper_confirmDelNavAction;
Helper.<span class="reserved">prototype</span>.confirmDelPageAction = Helper_confirmDelPageAction;
Helper.<span class="reserved">prototype</span>.confirmDelProjectAction = Helper_confirmDelProjectAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplTypeAction = Helper_confirmDelTplTypeAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplSetsAction = Helper_confirmDelTplSetsAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplGlobalAction = Helper_confirmDelTplGlobalAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplGlobalfileAction = Helper_confirmDelTplGlobalfileAction;
Helper.<span class="reserved">prototype</span>.getAttrParentNode = Helper_getAttrParentNode;
Helper.<span class="reserved">prototype</span>.getAttrParentNodeNextNode = Helper_getAttrParentNodeNextNode;
Helper.<span class="reserved">prototype</span>.getAttr = Helper_getAttr;
Helper.<span class="reserved">prototype</span>.getAttrNextSibling = Helper_getAttrNextSibling;
Helper.<span class="reserved">prototype</span>.getNextSiblingFirstChild = Helper_getNextSiblingFirstChild;
Helper.<span class="reserved">prototype</span>.getDataParentNode = Helper_getDataParentNode;
Helper.<span class="reserved">prototype</span>.getParentNodeNextSibling = Helper_getParentNodeNextSibling;
Helper.<span class="reserved">prototype</span>.convertFieldValuesToValidUrl = Helper_convertFieldValuesToValidUrl;
Helper.<span class="reserved">prototype</span>.URLify = Helper_URLify;
Helper.<span class="reserved">prototype</span>.adoptBox = Helper_adoptBox;
Helper.<span class="reserved">prototype</span>.loaderAdoptBox = Helper_loaderAdoptBox;
Helper.<span class="reserved">prototype</span>.showResponseAdoptBox = Helper_showResponseAdoptBox;


<span class="comment">/**
 * Launch popup.
 * &lt;br /&gt;
 * On the basis of parameter &lt;em&gt;trigger&lt;/em&gt; we builds the url string
 * for later use in func &lt;em&gt;window.open&lt;/em&gt;.
 * According to the popup launch, the parent window opacity will be lowered
 * to eye focus onto the launched window. 
 * 
 * &lt;br /&gt;&lt;br /&gt;Example:
 * &lt;pre&gt;&lt;code&gt;
Helper.launchPopup('mm_upload', this);
&lt;/code&gt;&lt;/pre&gt;
 * 
 * <span class="attrib">@see</span> #lowerOpacity
 * <span class="attrib">@see</span> #getPagerPage
 * <span class="attrib">@param</span> {string} trigger Switch case condition which url to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_launchPopup (trigger, elem)
{
	try {
		<span class="comment">// properties</span>
		<span class="reserved">this</span>.elem = elem;
		<span class="reserved">this</span>.trigger = trigger;
		
		Helper.lowerOpacity();		
		Helper.getPagerPage();
		
		switch (<span class="reserved">this</span>.trigger) {
			case <span class="literal">'mm_upload'</span> :
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseMedUploadPath + <span class="literal">'?pager_page='</span> + Helper.getPagerPage();
				break;
			case <span class="literal">'mm_edit'</span> :
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseMedEditPath + <span class="literal">'?id='</span> + <span class="reserved">this</span>.elem.id + <span class="literal">'&amp;pager_page='</span> + Helper.getPagerPage();
				break;
		}
		<span class="comment">// properties</span>
		<span class="reserved">this</span>.targetUrl = <span class="reserved">this</span>.url;
		<span class="reserved">this</span>.targetName = <span class="reserved">this</span>.trigger;
		<span class="reserved">this</span>.targetWidth = <span class="reserved">this</span>.callbacksPopupWindowWidth745;
		<span class="reserved">this</span>.targetHeight = <span class="reserved">this</span>.callbacksPopupWindowHeight634;
		<span class="reserved">this</span>.target = window.open(<span class="reserved">this</span>.targetUrl, <span class="reserved">this</span>.targetName, 
				<span class="literal">"scrollbars=yes,width="</span>+<span class="reserved">this</span>.targetWidth+<span class="literal">",height="</span>+<span class="reserved">this</span>.targetHeight+<span class="literal">""</span>);
		<span class="reserved">this</span>.resWidth = Helper.defineWindowX(<span class="reserved">this</span>.targetWidth);
		<span class="reserved">this</span>.resHeight = Helper.defineWindowY();	
		<span class="reserved">this</span>.target.moveBy(<span class="reserved">this</span>.resWidth, <span class="reserved">this</span>.resHeight);
		<span class="reserved">this</span>.target.focus();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get current text converter form value.
 * 
 * <span class="attrib">@see</span> #processCallbacks
 * <span class="attrib">@see</span> Mediamanager#processMediaCallbacks
 * <span class="attrib">@returns</span> text_converter
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getTextConverterValue ()
{
	try {		
		<span class="comment">// init</span>
		var text_converter;
		
		var form_name = Helper.getAttr(<span class="literal">'id'</span>, document.getElementsByClassName(<span class="literal">'botbg'</span>)[0]);
		var el_name = <span class="literal">'text_converter'</span>;
		var el_id = form_name + <span class="literal">'_text_converter'</span>;
			
		<span class="reserved">if</span> ($(el_id)) {
			var e = document.forms[form_name].elements[el_name];		
			<span class="reserved">for</span> (var i = 0; i &lt; e.length; i++) {
				<span class="reserved">if</span> (e.options[i].selected == true)
					var _text_converter = e.options[i].value;
			}
			text_converter = _text_converter;
		} <span class="reserved">else</span> {
			text_converter = 0;
		}
		<span class="reserved">return</span> text_converter;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get current textarea selection.
 * 
 * <span class="attrib">@see</span> #processCallbacks
 * <span class="attrib">@see</span> Mediamanager#processMediaCallbacks
 * <span class="attrib">@returns</span> text
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getSelectionText(el)
{
	try {
		<span class="reserved">if</span> (el) {
			<span class="comment">// used within callacks</span>
			var txtarea = el.replace(/^(_)(.+$)/, <span class="literal">'$2'</span>);
			txtarea = $(txtarea);
		} <span class="reserved">else</span> {
			<span class="comment">// used within mediamanager callacks</span>
			txtarea = $(form_target);
		}
		
		<span class="comment">// init</span>
		var text;
		
		<span class="reserved">if</span>(document.selection) {
			var theSelection = document.selection.createRange().text;
			text = theSelection;
		} <span class="reserved">else</span> <span class="reserved">if</span>(txtarea.selectionStart || txtarea.selectionStart == <span class="literal">'0'</span>) {
	 		var startPos = txtarea.selectionStart;
			var endPos = txtarea.selectionEnd;
			text = (txtarea.value).substring(startPos, endPos);
		} <span class="reserved">else</span> {
			text = <span class="literal">''</span>;
		}
		<span class="reserved">return</span> text;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get current delimiter value.
 * &lt;br /&gt;
 * In some cases it is required to change the delimiter to avoid syntax
 * conflicts while inserting references (e.g. working with cascading
 * style sheets or javascript, which uses brackets also).
 * 
 * <span class="attrib">@see</span> #processCallbacks
 * <span class="attrib">@returns</span> delimiter
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getDelimiterValue()
{
	try {
		<span class="comment">// init</span>
		var delimiter;
		
		<span class="reserved">if</span> ($(<span class="literal">'global_template_change_delimiter'</span>)) {
			delimiter = $F(<span class="literal">'global_template_change_delimiter'</span>);
		} <span class="reserved">else</span> {
			delimiter = <span class="literal">''</span>;
		}
		<span class="reserved">return</span> delimiter;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get the current pager page value.
 * &lt;br /&gt;
 * This is needed for Mediamanager action popups (&lt;em&gt;upload&lt;/em&gt;, &lt;em&gt;edit&lt;/em&gt;)
 * which supposed to refresh the content display on close of popup.
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@see</span> #processCallbacks
 * <span class="attrib">@see</span> Mediamanager#processMediaCallbacks
 * <span class="attrib">@returns</span> pager_page
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getPagerPage()
{
	try {
		<span class="comment">// init</span>
		var pager_page;
		
		<span class="reserved">if</span>($(<span class="literal">'pager_page_container'</span>)) {
			pager_page = $(<span class="literal">'pager_page_container'</span>).firstChild.nodeValue;
		} <span class="reserved">else</span> {
			pager_page = <span class="literal">''</span>;
		}
		<span class="reserved">return</span> pager_page;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get current insert type url string.
 * &lt;br /&gt;
 * We fetch the form tag action string and perform a regex.
 * This is used within {<span class="attrib">@link</span> #processCallbacks} to differ how to treat
 * the callbacks strings we build in callbacks.php.
 * 
 * <span class="attrib">@see</span> #processCallbacks
 * <span class="attrib">@returns</span> insert_type
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getInsertType ()
{
	try {		
		var insert_type_path = Helper.getAttr(<span class="literal">'action'</span>, document.getElementsByClassName(<span class="literal">'botbg'</span>)[0]);
		var insert_type = insert_type_path.replace(/^\/(.+)\/(.+)\/(.+$)/, <span class="literal">'$2'</span>);
		
		<span class="reserved">if</span> (insert_type == <span class="literal">'templating'</span>) {
			insert_type = <span class="literal">'InternalReference'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (insert_type == <span class="literal">'content'</span>) {
			insert_type = <span class="literal">'InternalLink'</span>;
		}
		<span class="reserved">return</span> insert_type;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Close popup and refresh Media Manager contents.
 * &lt;br /&gt;
 * In addition to close the popup, we invoke functions in the parent window,
 * like revoke the lowering of opacity and refresh the Media Manager to reflect
 * the modified contents.
 * &lt;br /&gt;
 * Used in popups where it is expected to close the window with a button.
 * 
 * <span class="attrib">@see</span> Mediamanager#invokePager
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closePopup ()
{       
	try {
		<span class="comment">/* invoke function in parent window */</span>
		self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;
		self.opener.Mediamanager.invokePager(<span class="literal">''</span>, pager_page);
		
		<span class="comment">/* Needed for func closePopupTrack(noAlert) */</span>
		audit = true;
		
		<span class="comment">/* set a timeout since the opened window has
		 to be present til process function in parent is executed */</span>
		setTimeout (<span class="literal">"self.close()"</span>, 1200);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Close popup.
 * &lt;br /&gt;
 * In addition to close the popup, we revoke the lowering of opacity.
 * Used in popups where it is expected to close the window with a href link.
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closeLinksPopup ()
{       
	try {
		<span class="comment">/* invoke function in parent window */</span>
		self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;

		<span class="comment">/* Needed for func closePopupTrack(NoAlert) */</span>
		audit = true;
					
		<span class="comment">/* set a timeout since the opened window has
		 to be present til process function in parent is executed */</span>
		setTimeout (<span class="literal">"self.close()"</span>, 100);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Track the close of popups with expected refresh of Media Manager.
 * &lt;br /&gt;
 * We need a handling if the user do not close the popups with the
 * appropriate buttons. For example, the user could use
 * keyboard shortcuts or close the popup by mouse click on the
 * window interface close button (depends on operating system).
 * &lt;br /&gt;
 * So this function is added to the popups html body event &lt;em&gt;onunload&lt;/em&gt;,
 * where its expected to close &lt;em&gt;and&lt;/em&gt; refresh the Media Manager (with {<span class="attrib">@link</span> #closePopup}).
 * There is a condition, that compares wether several control vars
 * (&lt;em&gt;audit&lt;/em&gt;, &lt;em&gt;submitted&lt;/em&gt;) are set (respectively are &lt;em&gt;bool&lt;/em&gt; true)
 * or not. On the basis of the result, we invoke functions in the parent window,
 * like revoke the lowering of opacity and fire a alert demanding to close the
 * popup with the appropriate button or link. 
 * 
 * <span class="attrib">@param</span> {global} audit Defined in {<span class="attrib">@link</span> #closePopup}.
 * <span class="attrib">@param</span> {global} submitted Avoid the execute of the onunload event.
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closePopupTrack (elem)
{       
	try {
		<span class="comment">// define global vars als false if not set</span>
		<span class="reserved">if</span> (typeof audit == <span class="literal">'undefined'</span>) {
			audit = false;
		}
		<span class="reserved">if</span> (typeof submitted == <span class="literal">'undefined'</span>) {
			submitted = false;
		}
		<span class="reserved">if</span> (audit !== true &amp;&amp; submitted !== true) {
			self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;
			self.opener.alert(alertOnClosePopup);
			<span class="comment">// reset global vars</span>
			audit = false;
			submitted = false;
		}	
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Track the close of popups which contains href links as close action.
 * &lt;br /&gt;
 * We need a handling if the user do not close the popups with the
 * appropriate link. For example, the user could use
 * keyboard shortcuts or close the popup by mouse click on the
 * window interface close button (depends on operating system).
 * &lt;br /&gt;
 * So this function is added to the popups html body event &lt;em&gt;onunload&lt;/em&gt;.
 * There is a condition, that compares wether the control var
 * (&lt;em&gt;audit&lt;/em&gt;) are set (respectively are &lt;em&gt;bool&lt;/em&gt; true)
 * or not. On the basis of the result, we revoke the lowering of opacity in the parent window.
 * 
 * <span class="attrib">@param</span> {global} audit Defined in {<span class="attrib">@link</span> #closeLinksPopup}.
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closePopupTrackNoAlert (elem)
{       
	try {
		<span class="comment">// define global vars als false if not set		</span>
		<span class="reserved">if</span> (typeof audit == <span class="literal">'undefined'</span>) {
			audit = false;
		}
		<span class="reserved">if</span> (typeof submitted == <span class="literal">'undefined'</span>) {
			submitted = false;
		}
		<span class="reserved">if</span> (audit !== true &amp;&amp; submitted !== true) {
			self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;
			<span class="comment">// reset global vars</span>
			audit = false;
			submitted = false;
		}	
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Lower opacity via DOM build Layer.
 * &lt;br /&gt;
 * Here we build a layer per DOM, which use a transparent PNG image.
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_lowerOpacity ()
{       
	try {
 		<span class="comment">// properties</span>
        <span class="reserved">this</span>.cLeft = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cTop = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cPosition = <span class="literal">'absolute'</span>;
        <span class="reserved">this</span>.cDisplay = <span class="literal">'block'</span>;
        <span class="reserved">this</span>.imagePath = <span class="literal">'../static/img/bg_overlay.png'</span>;
		<span class="reserved">this</span>.lyContainer = $(<span class="literal">'container'</span>);   
        <span class="reserved">this</span>.buildHeight = <span class="reserved">this</span>.lyContainer.offsetHeight;
        <span class="reserved">this</span>.buildWidth = <span class="reserved">this</span>.lyContainer.offsetWidth;
		<span class="reserved">this</span>.imageStr = <span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.imagePath + <span class="literal">'" width="'</span> + <span class="reserved">this</span>.buildWidth + <span class="literal">'" height="'</span> + <span class="reserved">this</span>.buildHeight +<span class="literal">'" alt="" /&gt;'</span>;
		<span class="reserved">this</span>.targetToLower = $(<span class="literal">'lyLowerOpacity'</span>);

        <span class="reserved">if</span> (<span class="reserved">this</span>.targetToLower) {
		 	<span class="reserved">this</span>.targetToLower.style.display = <span class="reserved">this</span>.cDisplay;
			<span class="reserved">this</span>.targetToLower.style.position = <span class="reserved">this</span>.cPosition;
			<span class="reserved">this</span>.targetToLower.style.top = <span class="reserved">this</span>.cTop;
			<span class="reserved">this</span>.targetToLower.style.left = <span class="reserved">this</span>.cLeft;
			<span class="reserved">this</span>.targetToLower.style.height = <span class="reserved">this</span>.buildHeight + <span class="literal">'px'</span>;
			<span class="reserved">this</span>.targetToLower.style.width = <span class="reserved">this</span>.buildWidth + <span class="literal">'px'</span>;
			
			Element.update(<span class="reserved">this</span>.targetToLower, <span class="reserved">this</span>.imageStr);
        }
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Lower opacity via DOM build Layer on load of page.
 * &lt;br /&gt;
 * Here we build a layer per DOM, which use a transparent PNG image.
 * Used within popups.
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_lowerOpacityOnUpload ()
{       
	try {
 		<span class="comment">// properties</span>
        <span class="reserved">this</span>.cLeft = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cTop = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cPosition = <span class="literal">'absolute'</span>;
        <span class="reserved">this</span>.cDisplay = <span class="literal">'block'</span>;
        <span class="reserved">this</span>.imagePath = <span class="literal">'../static/img/bg_overlay.png'</span>;
		<span class="reserved">this</span>.lyContainer = $(<span class="literal">'modalWindow'</span>);   
        <span class="reserved">this</span>.buildHeight = <span class="reserved">this</span>.lyContainer.offsetHeight;
        <span class="reserved">this</span>.buildWidth = <span class="reserved">this</span>.lyContainer.offsetWidth;
		<span class="reserved">this</span>.imageStr = <span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.imagePath + <span class="literal">'" width="'</span> + <span class="reserved">this</span>.buildWidth + <span class="literal">'" height="'</span> + <span class="reserved">this</span>.buildHeight +<span class="literal">'" alt="" /&gt;'</span>;
		<span class="reserved">this</span>.targetToLower = $(<span class="literal">'lyLowerOpacity'</span>);

        <span class="reserved">if</span> (<span class="reserved">this</span>.targetToLower) {
		 	<span class="reserved">this</span>.targetToLower.style.display = <span class="reserved">this</span>.cDisplay;
			<span class="reserved">this</span>.targetToLower.style.position = <span class="reserved">this</span>.cPosition;
			<span class="reserved">this</span>.targetToLower.style.top = <span class="reserved">this</span>.cTop;
			<span class="reserved">this</span>.targetToLower.style.left = <span class="reserved">this</span>.cLeft;
			<span class="reserved">this</span>.targetToLower.style.height = <span class="reserved">this</span>.buildHeight + <span class="literal">'px'</span>;
			<span class="reserved">this</span>.targetToLower.style.width = <span class="reserved">this</span>.buildWidth + <span class="literal">'px'</span>;
				
			Element.update(<span class="reserved">this</span>.targetToLower, <span class="reserved">this</span>.imageStr);
        }
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Check browser and his version.
 * &lt;br /&gt;
 * Sometimes we need this to distinguish between browser
 * and versions to intercept their different abilities.
 *
 * <span class="attrib">@returns</span> Boolean
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_isBrowser(_browser, _version)
{	
	try {
		<span class="reserved">this</span>.browser = _setBrowserString();
		<span class="reserved">this</span>.version = _setBrowserStringVersion();
			
		<span class="reserved">if</span> (<span class="reserved">this</span>.browser == _browser) {
			<span class="reserved">if</span> (_version) {
				<span class="reserved">if</span>(<span class="reserved">this</span>.version == _version) {
					<span class="reserved">return</span> true;
				} <span class="reserved">else</span> {
					<span class="reserved">return</span> false;
				}
			} <span class="reserved">else</span> {
				<span class="reserved">return</span> true;
			}
		} <span class="reserved">else</span> { 
			<span class="reserved">return</span> false;
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process given navigator.agent string to find out browser name.
 * Helper for {<span class="attrib">@link</span> #isBrowser}.
 *
 * <span class="attrib">@private</span>
 * <span class="attrib">@returns</span> var
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _compare (string)
{
	try {
		res = detect.indexOf(string) + 1;
		thestring = string;
		<span class="reserved">return</span> res;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get navigator.agent, compare it, fill global var and return it.
 * Helper for {<span class="attrib">@link</span> #isBrowser}.
 *
 * <span class="attrib">@private</span>
 * <span class="attrib">@returns</span> var browser
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _setBrowserString ()
{
	try {			
		detect = navigator.userAgent.toLowerCase();
		var browser;

		<span class="reserved">if</span> (_compare(<span class="literal">'safari'</span>)) {
			browser = <span class="literal">'sa'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (_compare(<span class="literal">'msie'</span>)) {
			browser = <span class="literal">'ie'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (_compare(<span class="literal">'firefox'</span>)) {
			browser = <span class="literal">'ff'</span>;
		}
		<span class="reserved">else</span> {
			browser = <span class="literal">''</span>;
		}
		<span class="reserved">return</span> browser;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process given navigator.agent string to find out agent version.
 * Helper for {<span class="attrib">@link</span> #isBrowser}.
 *
 * <span class="attrib">@private</span>
 * <span class="attrib">@returns</span> var browser
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _setBrowserStringVersion ()
{
	try {			
		_setBrowserString();
		var version;		
		version = detect.charAt(res + thestring.length);
		<span class="reserved">return</span> version;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Define and resize window width.
 * &lt;br /&gt;
 * Center the new window depending on giving Width.
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@param</span> {var} elemWidth Given width
 * <span class="attrib">@return</span> {number} x
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_defineWindowX (elemWidth)
{
	try {
		<span class="comment">//properties</span>
		<span class="reserved">this</span>.el = elemWidth;
		var x;
		
		<span class="comment">// all except Explorer</span>
		<span class="reserved">if</span> (self.innerHeight) {
			x = Math.round(self.innerWidth) - (Math.round(<span class="reserved">this</span>.el));
		}
		<span class="comment">// Explorer 6 Strict Mode</span>
		<span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.clientHeight) {
			x = Math.round(document.documentElement.clientWidth) - (Math.round(<span class="reserved">this</span>.el));
		}
		<span class="comment">// other Explorers</span>
		<span class="reserved">else</span> <span class="reserved">if</span> (document.body) {
			x = Math.round(document.body.clientWidth) - (Math.round(<span class="reserved">this</span>.el));
		}
		x = Math.round(x/2);
		<span class="reserved">return</span> x;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Define and resize window height.
 * &lt;br /&gt;
 * Center the new window depending on calculated height.
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@throws</span> applyError on exception
 * <span class="attrib">@return</span> {number} y
 */</span>
<span class="reserved">function</span> Helper_defineWindowY ()
{
	try {
		<span class="comment">//properties</span>
		var y;
	
		<span class="comment">// all except Explorer</span>
		<span class="reserved">if</span> (self.innerHeight) { 
			y = Math.round(self.innerHeight/6);
		}
		<span class="comment">// Explorer 6 Strict Mode</span>
		<span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.clientHeight) {
			y = Math.round(document.documentElement.clientHeight/6);
		}
		<span class="comment">// other Explorers</span>
		<span class="reserved">else</span> <span class="reserved">if</span> (document.body) {
			y = Math.round(document.body.clientHeight/6);
		}
		<span class="reserved">return</span> y;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Define window scroll offset.
 * &lt;br /&gt;
 * Returns the scroll offset of page.
 * Adapted from http://www.quirksmode.org/
 * 
 * <span class="attrib">@see</span> #loaderChangeBlogCommentStatus
 * <span class="attrib">@throws</span> applyError on exception
 * <span class="attrib">@return</span> {number} y
 */</span>
<span class="reserved">function</span> Helper_definePageY ()
{
	try {
		var y;
		
		<span class="comment">// all except Explorer</span>
		<span class="reserved">if</span> (self.pageYOffset) {
			y = self.pageYOffset;
		}
		<span class="comment">// Explorer 6 Strict</span>
		<span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.scrollTop) {
			y = document.documentElement.scrollTop;
		}
		<span class="comment">// all other Explorers</span>
		<span class="reserved">else</span> <span class="reserved">if</span> (document.body) {
			y = document.body.scrollTop;
		}
		<span class="reserved">return</span> y;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Show next appropriate DOM node.
 * &lt;br /&gt;
 * Used in internal links popups to reflect sitemap structure.
 * 
 * <span class="attrib">@see</span> #loaderPagesLinks
 * <span class="attrib">@see</span> #showResponsePagesSecondLinks
 * <span class="attrib">@see</span> #showResponsePagesThirdLinks
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showNextNode(elem)
{
	try {		
		<span class="comment">// init</span>
		var nextNode;
		
		<span class="comment">// get source node id from element</span>
		var sourceNode = elem.parentNode.parentNode.parentNode.parentNode.parentNode;
		
		<span class="comment">// get next possible node id</span>
		<span class="reserved">if</span> (sourceNode.id != <span class="literal">'thirdNode'</span>) {
			nextNode = Helper.getAttrNextSibling(<span class="literal">'id'</span>, sourceNode, 2);
			<span class="reserved">if</span> (Helper.isBrowser(<span class="literal">'ie'</span>)) {
				nextNode = Helper.getAttrNextSibling(<span class="literal">'id'</span>, sourceNode, 1);
			}
		}
		var url = <span class="reserved">this</span>.parseCallbacksFilePath + elem.name + <span class="literal">'.php'</span>;
		var pars = <span class="literal">'id='</span> + elem.id +<span class="literal">'&amp;nextNode='</span> + nextNode;	
		
		<span class="reserved">if</span> (nextNode == <span class="literal">'secondNode'</span>) {
		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				parameters : pars,
				onLoading : Helper.loaderPagesLinks,
				onComplete : Helper.showResponsePagesSecondLinks
			});
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (nextNode == <span class="literal">'thirdNode'</span>) {
		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				parameters : pars,
				onLoading : Helper.loaderPagesLinks,
				onComplete : Helper.showResponsePagesThirdLinks
			});
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Show next appropriate DOM node.
 * &lt;br /&gt;
 * Used in insert boxes popups to reflect sitemap structure.
 * 
 * <span class="attrib">@see</span> #loaderPagesLinks
 * <span class="attrib">@see</span> #showResponsePagesSecondLinks
 * <span class="attrib">@see</span> #showResponsePagesThirdLinks
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showNextNodeBoxes(elem)
{
	try {
		<span class="comment">//init</span>
		var nextNode;
		
		<span class="comment">// get source node id from element</span>
		var sourceNode = elem.parentNode.parentNode.parentNode.parentNode.parentNode;
		
		<span class="comment">// get next possible node id</span>
		<span class="reserved">if</span> (sourceNode.id != <span class="literal">'thirdNode'</span>) {
			nextNode = Helper.getAttrNextSibling(<span class="literal">'id'</span>, sourceNode, 2);
			<span class="reserved">if</span> (Helper.isBrowser(<span class="literal">'ie'</span>)) {
				nextNode = Helper.getAttrNextSibling(<span class="literal">'id'</span>, sourceNode, 1);
			}
		}	
		<span class="comment">//var url = this.parsePagesBoxesLinksPath;</span>
		var url = <span class="reserved">this</span>.parseCallbacksFilePath + elem.name + <span class="literal">'.php'</span>;
		var pars = <span class="literal">'id='</span> + elem.id +<span class="literal">'&amp;nextNode='</span> + nextNode;
		
		<span class="reserved">if</span> (nextNode == <span class="literal">'secondNode'</span>) {
		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				parameters : pars,
				onLoading : Helper.loaderPagesLinks,
				onComplete : Helper.showResponsePagesSecondLinks
			});
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Display indicator while XMLHttpRequest processing.
 *
 * <span class="attrib">@see</span> #showNextNode
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_loaderPagesLinks ()
{
	try {
		Element.show(<span class="literal">'indicator_pagesLinks'</span>);
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Populate on XMLHttpRequest Response.
 *
 * <span class="attrib">@see</span> #showNextNode
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponsePagesSecondLinks(req)
{
	try {
		Effect.Fade(<span class="literal">'indicator_pagesLinks'</span>, {duration: 0.4});
		Effect.Appear(<span class="literal">'secondNode'</span>,{duration: 0.6});
		$(<span class="literal">'secondNode'</span>).innerHTML = req.responseText;		
		Behaviour.reapply(<span class="literal">'a.process_insert'</span>);
		Behaviour.reapply(<span class="literal">'a.showNextNode'</span>);
		Behaviour.reapply(<span class="literal">'a.showNextNodeBoxes'</span>);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Populate on XMLHttpRequest Response.
 *
 * <span class="attrib">@see</span> #showNextNode
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponsePagesThirdLinks(req)
{
	try {
		Effect.Fade(<span class="literal">'indicator_pagesLinks'</span>, {duration: 0.4});
		Effect.Appear(<span class="literal">'thirdNode'</span>,{duration: 0.6});	
		$(<span class="literal">'thirdNode'</span>).innerHTML = req.responseText;		
		Behaviour.reapply(<span class="literal">'a.process_insert'</span>);
		Behaviour.reapply(<span class="literal">'a.showNextNode'</span>);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process inserting content.
 * &lt;br /&gt;
 * Adapted from http://sourceforge.net/projects/wikipedia
 * 
 * <span class="attrib">@see</span> Mediamanager#showResponseProcessMediaCallbacks
 * <span class="attrib">@param</span> {string} id Form element to populate
 * <span class="attrib">@param</span> {string} str Opening part of build string
 * <span class="attrib">@param</span> {string} tagClose Closing part of build string
 * <span class="attrib">@param</span> {string} sampleText Text to set, when we use str and tagClose
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertTagsCallbacks(id, str)
{
	try {
		<span class="comment">/* oberserve this!
		
		We have to distinguish here, because the IE is obviously too dumb to differ between elements
		which has the same value on different attributes (name, id). Here we have a conflict with
		the form hidden field attribute. So we serve IE by object forms[elements], while all others
		are able to use the standards (pointing the element by document.getElementById().
		
	 	if (Helper.isBrowser('ie')) {
			var _form_name = id.replace(/(.+)(_.+$)/, '$1');
			var txtarea = document.forms[_form_name].elements[id];
		} else {
			var txtarea = $(id);
		}
		*/</span>		
		var txtarea = $(id);
		
		<span class="comment">// IE</span>
		<span class="reserved">if</span>(document.selection) {
			var theSelection = document.selection.createRange().text;
			txtarea.focus();
			<span class="reserved">if</span>(theSelection.charAt(theSelection.length - 1) == <span class="literal">" "</span>){<span class="comment">// exclude ending space char, if any</span>
				theSelection = theSelection.substring(0, theSelection.length - 1);
				document.selection.createRange().text = str + theSelection + <span class="literal">" "</span>;
			} <span class="reserved">else</span> {
				document.selection.createRange().text = str + theSelection;
			}
		<span class="comment">// Mozilla</span>
		} <span class="reserved">else</span> <span class="reserved">if</span>(txtarea.selectionStart || txtarea.selectionStart == <span class="literal">'0'</span>) {
	 		var startPos = txtarea.selectionStart;
			var endPos = txtarea.selectionEnd;
			var scrollTop=txtarea.scrollTop;
			var myText = (txtarea.value).substring(startPos, endPos);
			subst = str;
			txtarea.value = txtarea.value.substring(0, startPos) + subst + txtarea.value.substring(endPos, txtarea.value.length);		
			txtarea.focus();
			var cPos=startPos+(str.length);
			txtarea.selectionStart=cPos;
			txtarea.selectionEnd=cPos;
			txtarea.scrollTop=scrollTop;
		}
		<span class="comment">// reposition cursor if possible</span>
		<span class="reserved">if</span> (txtarea.createTextRange) txtarea.caretPos = document.selection.createRange().duplicate();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process inserting content.
 * &lt;br /&gt;
 * Adapted from http://sourceforge.net/projects/wikipedia
 * 
 * <span class="attrib">@see</span> #showResponseProcessCallbacks
 * <span class="attrib">@param</span> {string} id Form element to populate
 * <span class="attrib">@param</span> {string} str Opening part of build string
 * <span class="attrib">@param</span> {string} tagClose Closing part of build string
 * <span class="attrib">@param</span> {string} sampleText Text to set, when we use str and tagClose
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertTagsFromPopupCallbacks(id, str)
{
	try {
		<span class="comment">/* oberserve this!
		
		We have to distinguish here, because the IE is obviously too dumb to differ between elements
		which has the same value on different attributes (name, id). Here we have a conflict with
		the form hidden field attribute. So we serve IE by object forms[elements], while all others
		are able to use the standards (pointing the element by document.getElementById().
		
		if (Helper.isBrowser('ie')) {
			var _form_name = id.replace(/(.+)(_.+$)/, '$1');
			var txtarea = opener.document.forms[_form_name].elements[id];
		} else {
			var txtarea = opener.$(id);
		}
		*/</span>
		var txtarea = opener.$(id);
		
		<span class="comment">// IE</span>
		<span class="reserved">if</span>(opener.document.selection) {
			var theSelection = document.selection.createRange().text;
			txtarea.focus();
			<span class="reserved">if</span>(theSelection.charAt(theSelection.length - 1) == <span class="literal">" "</span>){<span class="comment">// exclude ending space char, if any</span>
				theSelection = theSelection.substring(0, theSelection.length - 1);
				opener.document.selection.createRange().text = str + theSelection + <span class="literal">" "</span>;
			} <span class="reserved">else</span> {
				opener.document.selection.createRange().text = str + theSelection;
			}
		<span class="comment">// Mozilla</span>
		} <span class="reserved">else</span> <span class="reserved">if</span>(txtarea.selectionStart || txtarea.selectionStart == <span class="literal">'0'</span>) {
	 		var startPos = txtarea.selectionStart;
			var endPos = txtarea.selectionEnd;
			var scrollTop=txtarea.scrollTop;
			var myText = (txtarea.value).substring(startPos, endPos);
			subst = str;
			txtarea.value = txtarea.value.substring(0, startPos) + subst + txtarea.value.substring(endPos, txtarea.value.length);		
			txtarea.focus();
			var cPos=startPos+(str.length+myText.length);
			txtarea.selectionStart=cPos;
			txtarea.selectionEnd=cPos;
			txtarea.scrollTop=scrollTop;
		}
		<span class="comment">// reposition cursor if possible</span>
		<span class="reserved">if</span> (txtarea.createTextRange) txtarea.caretPos = opener.document.selection.createRange().duplicate();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process and handle internal callbacks.
 * &lt;br /&gt;
 * This function handles all the reference popups within the welcompose admin interface.
 * 
 * <span class="attrib">@see</span> #showResponseProcessCallbacks
 * <span class="attrib">@param</span> {string} elem Current elem to process
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_processCallbacks (elem)
{
	try {
		<span class="comment">// properties</span>
		<span class="reserved">this</span>.elem = elem;
		<span class="reserved">this</span>.elName = <span class="reserved">this</span>.elem.name;
		<span class="reserved">this</span>.elTarget = Helper.getAttrNextSibling(<span class="literal">'id'</span>, <span class="reserved">this</span>.elem, 1);
		
		<span class="reserved">this</span>.targetHeight = <span class="reserved">this</span>.callbacksPopupWindowHeight634;
		<span class="reserved">this</span>.targetName = <span class="reserved">this</span>.elTarget;
		
		Helper.lowerOpacity();
		
		<span class="comment">// used to differ between the popup window width</span>
		var win_names = {
			<span class="literal">'pages_links'</span>: <span class="reserved">this</span>.callbacksPopupWindowWidth745,
			<span class="literal">'structuraltemplates_links'</span>: <span class="reserved">this</span>.callbacksPopupWindowWidth460,
			<span class="literal">'globalboxes_links'</span>: <span class="reserved">this</span>.callbacksPopupWindowWidth460,
			<span class="literal">'globalfiles_links'</span>: <span class="reserved">this</span>.callbacksPopupWindowWidth460,
			<span class="literal">'globaltemplates_links'</span>: <span class="reserved">this</span>.callbacksPopupWindowWidth460,
			<span class="literal">'boxes_links'</span>: <span class="reserved">this</span>.callbacksPopupWindowWidth745
		};

		<span class="comment">// temp var used in for loop</span>
		var _width = <span class="reserved">this</span>.elTarget;
		
		<span class="comment">// execute url target width definition</span>
		<span class="reserved">for</span> (placeholder in win_names) {
			var n = new RegExp(placeholder, <span class="literal">'gi'</span>);
			_width = _width.replace(n, win_names[placeholder]);
			<span class="reserved">this</span>.targetWidth = _width;
		};
		
		<span class="comment">// path definitions for url</span>
		var url_paths = {
			<span class="literal">'pages_links'</span>: <span class="literal">'content'</span>,
			<span class="literal">'structuraltemplates_links'</span>: <span class="literal">'content'</span>,
			<span class="literal">'globalboxes_links'</span>: <span class="literal">'templating'</span>,
			<span class="literal">'globalfiles_links'</span>: <span class="literal">'templating'</span>,
			<span class="literal">'globaltemplates_links'</span>: <span class="literal">'templating'</span>,
			<span class="literal">'boxes_links'</span>: <span class="literal">'templating'</span>
		};
		
		<span class="comment">// temp var used in for loop</span>
		var _path = <span class="reserved">this</span>.elTarget;
		
		<span class="comment">// execute url paths definition</span>
		<span class="reserved">for</span> (placeholder in url_paths) {
			var n = new RegExp(placeholder, <span class="literal">'gi'</span>);
			_path = _path.replace(n, url_paths[placeholder]);
			<span class="reserved">this</span>.url = <span class="literal">'../'</span> + _path + <span class="literal">'/'</span> + <span class="reserved">this</span>.parseCallbacksFilePath + <span class="reserved">this</span>.elTarget;
		};
	
		<span class="comment">// grab enviroment variables</span>
		<span class="comment">// hash the returned variables</span>
		var getElems = {
			id : <span class="reserved">this</span>.elem.id,
			form_target : <span class="reserved">this</span>.elName,
			delimiter : Helper.getDelimiterValue(),
			text : Helper.getSelectionText(<span class="reserved">this</span>.elName),
			text_converter : Helper.getTextConverterValue(),
			pager_page : Helper.getPagerPage(),
			insert_type : Helper.getInsertType()
		};
		var o = $H(getElems);
		var reqString = o.toQueryString();
						
		<span class="reserved">this</span>.url = <span class="reserved">this</span>.url + <span class="literal">'.php'</span> + <span class="literal">'?'</span> + reqString;	
		<span class="reserved">this</span>.targetUrl = <span class="reserved">this</span>.url;
		<span class="reserved">this</span>.target = window.open(<span class="reserved">this</span>.targetUrl, <span class="reserved">this</span>.targetName, 
				<span class="literal">"scrollbars=yes,width="</span>+<span class="reserved">this</span>.targetWidth+<span class="literal">",height="</span>+<span class="reserved">this</span>.targetHeight+<span class="literal">""</span>);
		<span class="reserved">this</span>.resWidth = Helper.defineWindowX(<span class="reserved">this</span>.targetWidth);
		<span class="reserved">this</span>.resHeight = Helper.defineWindowY();

		<span class="reserved">this</span>.target.moveBy(<span class="reserved">this</span>.resWidth, <span class="reserved">this</span>.resHeight);
		<span class="reserved">this</span>.target.focus();		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Populate on XMLHttpRequest response.
 * &lt;br /&gt;
 * Insert the callback result string.
 *
 * <span class="attrib">@see</span> #processMediaCallbacks
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_callbacksInsert(elem)
{
	try {
		<span class="comment">// properties</span>
		<span class="reserved">this</span>.elem = elem;
		
		<span class="comment">// hash collected variables</span>
		var getElems = {
			id : <span class="reserved">this</span>.elem.id,
			form_target : form_target,
			delimiter : delimiter,
			text : text,
			text_converter : text_converter,
			pager_page : pager_page,
			insert_type : insert_type,
			type : <span class="reserved">this</span>.elem.name,
			posting_id : (<span class="reserved">this</span>.elem.name == <span class="literal">'blog_posting'</span>) ? Helper.getAttrNextSibling(<span class="literal">'id'</span>, <span class="reserved">this</span>.elem, 1) : <span class="literal">''</span>,
			year : (<span class="reserved">this</span>.elem.name == <span class="literal">'archive_year'</span> || <span class="reserved">this</span>.elem.name == <span class="literal">'archive_month'</span>)
			 			? Helper.getAttrNextSibling(<span class="literal">'id'</span>, <span class="reserved">this</span>.elem, 1) : <span class="literal">''</span>,
			month : (<span class="reserved">this</span>.elem.name == <span class="literal">'archive_month'</span>) ? Helper.getAttrNextSibling(<span class="literal">'id'</span>, <span class="reserved">this</span>.elem, 2) : <span class="literal">''</span>
		};
		var o = $H(getElems);
		var reqString = o.toQueryString();
		
		var url = <span class="reserved">this</span>.parseCallbacksPath;
		var pars = reqString;

		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'post'</span>,
				parameters : pars,
				onComplete : Helper.showResponseProcessCallbacks
			});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Populate on XMLHttpRequest response.
 * &lt;br /&gt;
 * Insert the callback result string.
 *
 * <span class="attrib">@see</span> #processMediaCallbacks
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponseProcessCallbacks(req)
{
	try {
		var _form_target = form_target.replace(/^(_)(.+$)/, <span class="literal">'$2'</span>);
		Helper.insertTagsFromPopupCallbacks(_form_target, req.responseText);
		Helper.closeLinksPopup();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Change blog comment status.
 * &lt;br/&gt;
 * Get the form select values with corresponding comment id
 * and edit on page.
 * 
 * <span class="attrib">@see</span> #loaderChangeBlogCommentStatus
 * <span class="attrib">@see</span> #showResponseChangeBlogCommentStatus
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_changeBlogCommentStatus (elem)
{	
	try {
		<span class="comment">// init</span>
		var statusId;
		var commentId;
		
		<span class="comment">// get status value</span>
		statusId = elem.options[elem.selectedIndex].value;
	
		<span class="comment">// find blog comment id</span>
		commentId = elem.parentNode.parentNode.parentNode;
		commentId = Helper.getNextSiblingFirstChild(commentId, 4);
		commentId = String(commentId.href);
		commentId = commentId.replace(/(.*?)(id\=+)(\d+)/g, <span class="literal">"$3"</span>);		

		<span class="comment">// properties</span>
		var url = <span class="reserved">this</span>.parseBlogCommmentStatusChangePath;
		var pars = <span class="literal">'status_id='</span> + statusId + <span class="literal">'&amp;comment_id='</span> + commentId;

		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				onLoading : Helper.loaderChangeBlogCommentStatus,
				parameters : pars,
				onComplete : Helper.showResponseChangeBlogCommentStatus
			});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Display indicator layer while XMLHttpRequest processing.
 * Triggers {<span class="attrib">@link</span> #lowerOpacity}.
 *
 * <span class="attrib">@see</span> #lowerOpacity
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_loaderChangeBlogCommentStatus ()
{
	try {
		Helper.lowerOpacity();

		<span class="reserved">this</span>.statuschange = $(<span class="literal">'statuschange'</span>);
		var winHeight = Helper.defineWindowY();
		var scrollPos = Helper.definePageY();		
		<span class="reserved">this</span>.statuschange.style.top = winHeight + scrollPos + 140 + <span class="literal">'px'</span>;
		
		Effect.Appear(<span class="reserved">this</span>.statuschange, {duration: 0.6, delay: 0.2});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Layer fadeout on XMLHttpRequest response.
 *
 * <span class="attrib">@see</span> #changeBlogCommentStatus
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponseChangeBlogCommentStatus(req)
{
	try {
		setTimeout(<span class="literal">"Effect.Fade('statuschange', {duration: 0.6})"</span>, 2000);
		setTimeout(<span class="literal">"$('lyLowerOpacity').style.display = 'none';"</span>, 2800);
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Display upload indicator.
 * Trigger {<span class="attrib">@link</span> #lowerOpacityOnUpload}. This is used on submit
 * within the media upload popup to indicate the upload still remains.
 *
 * <span class="attrib">@see</span> #lowerOpacityOnUpload
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showFileUploadMessage()
{
	try {
		Helper.lowerOpacityOnUpload();
		Effect.Appear(<span class="literal">'uploadMessage'</span>, {duration: 0.4});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Validate form elements on the fly.
 * &lt;br /&gt;
 * Get the form element id attribute value and populate the
 * regex processed response into the layer &lt;em&gt;container&lt;/em&gt;.
 * This assumes that we have corresponding html markup/css.
 * &lt;br /&gt;
 * For in depths explanation please have a look on the online
 * project support area.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_validate(elem)
{	
	var url		= <span class="reserved">this</span>.validatePath;
	elemID		= $(elem).getAttribute(<span class="literal">'id'</span>);
	var elemVal	= $F(elem);
	var pars	= <span class="literal">'elemID='</span> + elemID + <span class="literal">'&amp;elemVal='</span> + elemVal;
	var container = elemID + <span class="literal">'_container'</span>;
	
	var myAjax = new Ajax.Updater ( 
		{
			failure: container,
			success: container
		},
		url,
		{
			method: <span class="literal">'post'</span>,
			parameters: pars
		});		
}

<span class="comment">/**
 * Confirm navigation delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelNavAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelNav);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm page delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelPageAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelPage);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm project delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelProjectAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelProject);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm template type delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplTypeAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplType);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm template sets delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplSetsAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplSets);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm global template delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplGlobalAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplGlobal);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm global file delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplGlobalfileAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplGlobalfile);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Getter for parent node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Parent node attribute of element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttrParentNode (attr, elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.parentNode;
	}
		
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span>)
		<span class="reserved">return</span> a.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> a.getAttribute(attr);
}

<span class="comment">/**
 * Getter for current element parent node next node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Next node attribute of parent node of the current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttrParentNodeNextNode (attr, elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.parentNode;
	}	
	
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span>)
		a = a.nextSibling;
	<span class="reserved">else</span>
		a = a.nextSibling.nextSibling;

	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span>)
		<span class="reserved">return</span> a.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> a.getAttribute(attr);
}

<span class="comment">/**
 * Getter for node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@return</span> object Attribute of element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttr (attr, elem)
{
	<span class="reserved">this</span>.browser = _setBrowserString();
		
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span>)
		<span class="reserved">return</span> elem.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> elem.getAttribute(attr);
}


<span class="comment">/**
 * Getter for next sibling node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Next sibling attribute
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttrNextSibling (attr, elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.nextSibling;
	}
		
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span>)
		<span class="reserved">return</span> a.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> a.getAttribute(attr);
}

<span class="comment">/**
 * Getter for next sibling first child node attribute.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Next sibling first child value
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getNextSiblingFirstChild (elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();
	
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span> || <span class="reserved">this</span>.browser == <span class="literal">'sa'</span>)
		level-- ;

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.nextSibling;
	}
	<span class="reserved">return</span> a.firstChild;
}

<span class="comment">/**
 * Getter for parent node data.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Parent node data
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getDataParentNode (elem, level)
{
	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.parentNode;
	}
	<span class="reserved">return</span> Helper.trim(a.firstChild.nodeValue.toLowerCase());	
}

<span class="comment">/**
 * Getter for parent node next sibling.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Parent node next sibling
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getParentNodeNextSibling (elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();
	
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'ie'</span> || <span class="reserved">this</span>.browser == <span class="literal">'sa'</span>)
		level-- ;
		
	<span class="reserved">for</span> (var a = elem.parentNode; level &gt; 0; level--) {
		a = a.nextSibling;
	}
	<span class="reserved">if</span> (typeof a != <span class="literal">'undefined'</span>)
		<span class="reserved">return</span> a;
}

<span class="comment">/**
 * Wrapper to transform form field values to valid urls.
 * &lt;br /&gt;
 * Fills the related url form field with transformed values
 * ({link #URLify}) of the current form field element.
 *
 * <span class="attrib">@see</span> #URLify
 * <span class="attrib">@param</span> {string} elem Current Element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_convertFieldValuesToValidUrl (elem, attr)
{
	try {	
		<span class="comment">//properties</span>
		<span class="reserved">this</span>.elem = elem;
		<span class="reserved">this</span>.attr = attr;
		
		<span class="comment">/**
		* Helper func fails when the appropriate field help file has been activated.
		* Seems the DOM is actually not fully cleaned up after hide the help again.
		*/</span>		
		<span class="comment">// get next node (e.g. label) attribute</span>
		<span class="comment">//var el = Helper.getAttrParentNodeNextNode (this.attr, this.elem, 1);		</span>
		
		<span class="comment">/**
		* Since we plan to refactor the whole thing we do not pay much attention 
		* on this dumb error case. So we somewhat hardwire the event destination.
		*/</span>
		var el = $(<span class="reserved">this</span>.elem.id + <span class="literal">'_url'</span>);
		
		<span class="comment">// fill related form field with transformed results</span>
		$(el).value = Helper.URLify(<span class="reserved">this</span>.elem.value);
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Transforms form field values to valid urls.
 * 
 * <span class="attrib">@see</span> #convertFieldValuesToValidUrl
 * <span class="attrib">@param</span> {string} string given string
 * <span class="attrib">@return</span> string processed string
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_URLify (string)
{
	try {	
		<span class="comment">// convert string to lowercase so that we always operate on lowercases</span>
		string = string.toLowerCase();

		<span class="comment">// trim whitespaces</span>
		Helper.trim(string);
	
		<span class="comment">// definitions for char normalization</span>
		var normalizations = {
			<span class="comment">// german</span>
			<span class="literal">'ÃÂÃÂÃÂÃÂ¤'</span>: <span class="literal">'ae'</span>,
			<span class="literal">'ÃÂÃÂÃÂÃÂ¶'</span>: <span class="literal">'oe'</span>,
			<span class="literal">'ÃÂÃÂÃÂÃÂ¼'</span>: <span class="literal">'ue'</span>,
			<span class="literal">'ÃÂÃÂÃÂÃÂ'</span>: <span class="literal">'ss'</span>
			<span class="comment">// french</span>
		
			<span class="comment">// spanish</span>
		
			<span class="comment">// swedish</span>
		
			<span class="comment">// other</span>
		};
	
		<span class="comment">// execute char normalization</span>
		<span class="reserved">for</span> (placeholder in normalizations) {
			var r = new RegExp(placeholder, <span class="literal">'gi'</span>);
			string = string.replace(r, normalizations[placeholder]);
		};
	
		<span class="comment">// remove everything except a-z, 0-9 and hyphens and replace it with a hyphen </span>
		string = string.replace(/[^a-z0-9\-]/g, <span class="literal">'-'</span>);
	
		<span class="comment">// remove unnecessary hyphens</span>
		string = string.replace(/-{2,}/g, <span class="literal">'-'</span>);
	
		<span class="comment">// remove hyphens at the beginning and at the end of the string</span>
		string = string.replace(/^(-+)/, <span class="literal">''</span>);
		string = string.replace(/(-+)$/, <span class="literal">''</span>);
	
	    <span class="reserved">return</span> string;
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Binds available boxes to current page
 *
 * <span class="attrib">@param</span> {string} elem Current Element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_adoptBox (elem)
{
	try {
		Element.scrollTo(<span class="literal">'container'</span>);
	
		var page_name = elem.parentNode.parentNode;
		
		<span class="reserved">if</span> (Helper.isBrowser(<span class="literal">'ie'</span>)) {
			page_name = page_name.childNodes[1].innerHTML;
		} <span class="reserved">else</span> {
			page_name = page_name.childNodes[3].innerHTML;
		}
					
		var url = <span class="literal">'../content/pages_boxes_adopt.php'</span>;
		var pars = <span class="literal">'id='</span> + elem.id + <span class="literal">'&amp;page='</span> + elem.rel + <span class="literal">'&amp;page_name='</span> + page_name;
		
		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'post'</span>,
				parameters : pars,
				onLoading : Helper.loaderAdoptBox,
				onComplete : Helper.showResponseAdoptBox
			});
			
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Display indicator layer while XMLHttpRequest processing.
 *
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_loaderAdoptBox ()
{
	try {
		Element.show(<span class="literal">'indicator_adopt'</span>);
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Layer fadeout on XMLHttpRequest response.
 *
 * <span class="attrib">@see</span> #adoptBox
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponseAdoptBox(req)
{
	try {
		var el = $(<span class="literal">'boxes'</span>);
		var res = $(<span class="literal">'noresult'</span>);
		
		<span class="comment">// if resultset is empty replace DOM Element</span>
		<span class="comment">//  otherwise insert returned contents</span>
		<span class="reserved">if</span>(res){
			Element.replace(res, req.responseText);
		} <span class="reserved">else</span> {
			new Insertion.Bottom(el, req.responseText);
		}
		setTimeout(<span class="literal">"Effect.Fade('indicator_adopt', {duration: 0.4})"</span>, 300);
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Building new object instance of class Helper
 */</span>
Helper = new Helper();
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<TD ALIGN="right" VALIGN="middle">
<B>Welcompose<sup><small>TM</small></sup> Javascript API</B>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Wed Dec 10 08:00:14 2008</div>
</body>
</html>
