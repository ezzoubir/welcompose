<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
Welcompose Publishing System Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="wcom.helper.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>Welcompose Publishing System</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>wcom.helper.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Comprised javascript helper functions.
 It contains functions that may be used application wide.<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="Helper.html">Helper</a></b></td>
    <td>The Helper class defines a bunch of functions which doesn't 
 belongs as regards content to just one class.</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

	<a name="method_summary"><!-- --></a>
	<table border="1" cellpadding="3" cellspacing="0" width="100%">
		<tr bgcolor="#CCCCFF" class="TableHeadingColor">
			<td colspan=2>
				<font size="+2">
					<b>Method Summary</b>
				</font>
			</td>
		</tr>
	
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="Globals.html#!s!_compare">_compare</a></b>(string)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 UNDER DEVELOPMENT
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="Globals.html#!s!_setBrowserString">_setBrowserString</a></b>()
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 UNDER DEVELOPMENT
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="Globals.html#!s!_setBrowserStringOS">_setBrowserStringOS</a></b>()
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 UNDER DEVELOPMENT
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="Globals.html#!s!_setBrowserStringVersion">_setBrowserStringVersion</a></b>()
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 UNDER DEVELOPMENT
		      </td>
		   </tr>
		
	
	</table>
    <p>

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/**
 * Project: Welcompose
 * File: wcom.helper.js
 *
 * Copyright (c) 2006 sopic GmbH
 *
 * Project owner:
 * creatics media.systems, Olaf Gleba
 * 50939 KÃ¶ln, Germany
 * http://www.creatics.de
 *
 * This file is licensed under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE v3
 * http://www.opensource.org/licenses/agpl-v3.html
 *
 * $Id: wcom.helper.js 734 2006-12-12 16:43:13Z olaf $
 *
 * <span class="attrib">@copyright</span> 2006 creatics media.systems
 * <span class="attrib">@author</span> Olaf Gleba
 * <span class="attrib">@package</span> Welcompose
 * <span class="attrib">@license</span> http://www.opensource.org/licenses/osl-2.1.php Open Software License
 */</span>

<span class="comment">/** 
 * <span class="attrib">@fileoverview</span> Comprised javascript helper functions.
 * It contains functions that may be used application wide.
 */</span>



<span class="comment">/**
 * Constructs the Helper class
 * 
 * <span class="attrib">@class</span> The Helper class defines a bunch of functions which doesn't 
 * belongs as regards content to just one class. Several functions be in use
 * within every Welcompose class. The scope is application wide.
 *
 * <span class="attrib">@constructor</span>
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper ()
{
	try {
		<span class="comment">// no properties		</span>
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/* Inherit from Base */</span>
Helper.<span class="reserved">prototype</span> = new Base();


<span class="comment">/**
 * Instance Methods from prototype <span class="attrib">@class</span> Helper
 */</span>
Helper.<span class="reserved">prototype</span>.launchPopup = Helper_launchPopup;
Helper.<span class="reserved">prototype</span>.closePopup = Helper_closePopup;
Helper.<span class="reserved">prototype</span>.closeLinksPopup = Helper_closeLinksPopup;
Helper.<span class="reserved">prototype</span>.closePopupTrack = Helper_closePopupTrack;
Helper.<span class="reserved">prototype</span>.closePopupTrackNoAlert = Helper_closePopupTrackNoAlert;
Helper.<span class="reserved">prototype</span>.lowerOpacity = Helper_lowerOpacity;
Helper.<span class="reserved">prototype</span>.lowerOpacityOnUpload = Helper_lowerOpacityOnUpload;
Helper.<span class="reserved">prototype</span>.unsupportsEffects = Helper_unsupportsEffects;
Helper.<span class="reserved">prototype</span>.unsupportsElems = Helper_unsupportsElems;
Helper.<span class="reserved">prototype</span>.defineWindowX = Helper_defineWindowX;
Helper.<span class="reserved">prototype</span>.defineWindowY = Helper_defineWindowY;
Helper.<span class="reserved">prototype</span>.showNextNode = Helper_showNextNode;
Helper.<span class="reserved">prototype</span>.loaderPagesLinks = Helper_loaderPagesLinks;
Helper.<span class="reserved">prototype</span>.showResponsePagesSecondLinks = Helper_showResponsePagesSecondLinks;
Helper.<span class="reserved">prototype</span>.showResponsePagesThirdLinks = Helper_showResponsePagesThirdLinks;
Helper.<span class="reserved">prototype</span>.insertTagsFromPopup = Helper_insertTagsFromPopup;
Helper.<span class="reserved">prototype</span>.insertTags = Helper_insertTags;
Helper.<span class="reserved">prototype</span>.insertInternalLink = Helper_insertInternalLink;
Helper.<span class="reserved">prototype</span>.insertInternalLinkNoHref = Helper_insertInternalLinkNoHref;
Helper.<span class="reserved">prototype</span>.insertInternalLinkGlobalTemplates = Helper_insertInternalLinkGlobalTemplates;
Helper.<span class="reserved">prototype</span>.insertInternalLinkGlobalFiles = Helper_insertInternalLinkGlobalFiles;
Helper.<span class="reserved">prototype</span>.insertInternalLinkStructuralTemplates = Helper_insertInternalLinkStructuralTemplates;
Helper.<span class="reserved">prototype</span>.showResponseStructuralTemplates = Helper_showResponseStructuralTemplates;
Helper.<span class="reserved">prototype</span>.changeBlogCommentStatus = Helper_changeBlogCommentStatus;
Helper.<span class="reserved">prototype</span>.loaderChangeBlogCommentStatus = Helper_loaderChangeBlogCommentStatus;
Helper.<span class="reserved">prototype</span>.showResponseChangeBlogCommentStatus = Helper_showResponseChangeBlogCommentStatus;
Helper.<span class="reserved">prototype</span>.showFileUploadMessage = Helper_showFileUploadMessage;
Helper.<span class="reserved">prototype</span>.validate = Helper_validate;
Helper.<span class="reserved">prototype</span>.confirmDelNavAction = Helper_confirmDelNavAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplTypeAction = Helper_confirmDelTplTypeAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplSetsAction = Helper_confirmDelTplSetsAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplGlobalAction = Helper_confirmDelTplGlobalAction;
Helper.<span class="reserved">prototype</span>.confirmDelTplGlobalfileAction = Helper_confirmDelTplGlobalfileAction;
Helper.<span class="reserved">prototype</span>.getDelimiterValue = Helper_getDelimiterValue;
Helper.<span class="reserved">prototype</span>.getPagerPage = Helper_getPagerPage;
Helper.<span class="reserved">prototype</span>.getAttrParentNode = Helper_getAttrParentNode;
Helper.<span class="reserved">prototype</span>.getAttr = Helper_getAttr;
Helper.<span class="reserved">prototype</span>.getAttrNextSibling = Helper_getAttrNextSibling;
Helper.<span class="reserved">prototype</span>.getNextSiblingFirstChild = Helper_getNextSiblingFirstChild;
Helper.<span class="reserved">prototype</span>.getDataParentNode = Helper_getDataParentNode;



<span class="comment">/**
 * Launch popup.
 * &lt;br /&gt;
 * On the basis of parameter &lt;em&gt;trigger&lt;/em&gt; we builds the url string
 * for later use in func &lt;em&gt;window.open&lt;/em&gt;.
 * According to the popup launch, the parent window opacity will be lowered
 * to eye focus onto the launched window. 
 * 
 * &lt;br /&gt;&lt;br /&gt;Example:
 * &lt;pre&gt;&lt;code&gt;
Helper.launchPopup('745','634','pages_links_select','pages_internal_links', this);
&lt;/code&gt;&lt;/pre&gt;
 * 
 * <span class="attrib">@see</span> #lowerOpacity
 * <span class="attrib">@param</span> {string} width Width for the window to launch 
 * <span class="attrib">@param</span> {string} height Height for the window to launch
 * <span class="attrib">@param</span> {string} wname The Name for the window to launch
 * <span class="attrib">@param</span> {string} trigger Switch case condition which url to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_launchPopup (width, height, wname, trigger, elem)
{
	try {
		<span class="comment">// properties</span>
		<span class="reserved">this</span>.elem = elem;
		<span class="reserved">this</span>.trigger = trigger;
		
		Helper.lowerOpacity();
		
		switch (<span class="reserved">this</span>.trigger) {
			case <span class="literal">'mm_upload'</span> :
					Helper.getPagerPage();
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseMedUploadUrl + <span class="literal">'?pager_page='</span> + pager_page;
				break;
			case <span class="literal">'mm_edit'</span> :
					Helper.getPagerPage();
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseMedEditUrl + <span class="literal">'?id='</span> + <span class="reserved">this</span>.elem.id + <span class="literal">'&amp;pager_page='</span> + pager_page;
				break;
			case <span class="literal">'pages_internal_links'</span> :
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parsePagesLinksUrl + <span class="literal">'?target='</span> + <span class="reserved">this</span>.elem.name;
				break;
			case <span class="literal">'pages_internal_links_NoHref'</span> :
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parsePagesLinksUrl + <span class="literal">'?target='</span> + <span class="reserved">this</span>.elem.name + <span class="literal">'&amp;control=NoHref'</span>;
				break;
			case <span class="literal">'globaltemplates_internal_links'</span> :
					Helper.getDelimiterValue();
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseGlobalTemplatesLinksUrl + <span class="literal">'?target='</span> + <span class="reserved">this</span>.elem.name + <span class="literal">'&amp;delimiter='</span> + delimiter;
				break;
			case <span class="literal">'globalfiles_internal_links'</span> :
					Helper.getDelimiterValue();
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseGlobalFilesLinksUrl + <span class="literal">'?target='</span> + <span class="reserved">this</span>.elem.name + <span class="literal">'&amp;delimiter='</span> + delimiter;
				break;
			case <span class="literal">'structuraltemplates_internal_links'</span> :
					<span class="reserved">this</span>.url = <span class="reserved">this</span>.parseStructuralTemplatesLinksUrl + <span class="literal">'?target='</span> + <span class="reserved">this</span>.elem.name;
				break;
		}
		<span class="comment">// properties</span>
		<span class="reserved">this</span>.targetUrl = <span class="reserved">this</span>.url;
		<span class="reserved">this</span>.targetName = wname;
		<span class="reserved">this</span>.targetWidth = width;
		<span class="reserved">this</span>.targetHeight = height;
		<span class="reserved">this</span>.target = window.open(<span class="reserved">this</span>.targetUrl, <span class="reserved">this</span>.targetName, 
				<span class="literal">"scrollbars=yes,width="</span>+<span class="reserved">this</span>.targetWidth+<span class="literal">",height="</span>+<span class="reserved">this</span>.targetHeight+<span class="literal">""</span>);
		<span class="reserved">this</span>.resWidth = Helper.defineWindowX(<span class="reserved">this</span>.targetWidth);
		<span class="reserved">this</span>.resHeight = Helper.defineWindowY();
		
		<span class="reserved">this</span>.target.moveBy(<span class="reserved">this</span>.resWidth, <span class="reserved">this</span>.resHeight);
		<span class="reserved">this</span>.target.focus();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Close popup and refresh Media Manager contents.
 * &lt;br /&gt;
 * In addition to close the popup, we invoke functions in the parent window,
 * like revoke the lowering of opacity and refresh the Media Manager to reflect
 * the modified contents.
 * &lt;br /&gt;
 * Used in popups where it is expected to close the window with a button.
 * 
 * <span class="attrib">@see</span> Mediamanager#invokePager
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closePopup ()
{       
	try {
		<span class="comment">/* invoke function in parent window */</span>
		self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;
		self.opener.Mediamanager.invokePager(<span class="literal">''</span>, pager_page);
		
		<span class="comment">/* Needed for func closePopupTrack(noAlert) */</span>
		audit = true;
		
		<span class="comment">/* set a timeout since the opened window has
		 to be present til process function in parent is executed */</span>
		setTimeout (<span class="literal">"self.close()"</span>, 1200);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Close popup.
 * &lt;br /&gt;
 * In addition to close the popup, we revoke the lowering of opacity.
 * Used in popups where it is expected to close the window with a href link.
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closeLinksPopup ()
{       
	try {
		<span class="comment">/* invoke function in parent window */</span>
		self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;

		<span class="comment">/* Needed for func closePopupTrack(NoAlert) */</span>
		audit = true;
					
		<span class="comment">/* set a timeout since the opened window has
		 to be present til process function in parent is executed */</span>
		setTimeout (<span class="literal">"self.close()"</span>, 100);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Track the close of popups with expected refresh of Media Manager.
 * &lt;br /&gt;
 * We need a handling if the user do not close the popups with the
 * appropriate buttons. For example, the user could use
 * keyboard shortcuts or close the popup by mouse click on the
 * window interface close button (depends on operating system).
 * &lt;br /&gt;
 * So this function is added to the popups html body event &lt;em&gt;onunload&lt;/em&gt;,
 * where its expected to close &lt;em&gt;and&lt;/em&gt; refresh the Media Manager (with {<span class="attrib">@link</span> #closePopup}).
 * There is a condition, that compares wether several control vars
 * (&lt;em&gt;audit&lt;/em&gt;, &lt;em&gt;submitted&lt;/em&gt;) are set (respectively are &lt;em&gt;bool&lt;/em&gt; true)
 * or not. On the basis of the result, we invoke functions in the parent window,
 * like revoke the lowering of opacity and fire a alert demanding to close the
 * popup with the appropriate button or link. 
 * 
 * <span class="attrib">@param</span> {global} audit Defined in {<span class="attrib">@link</span> #closePopup}.
 * <span class="attrib">@param</span> {global} submitted Avoid the execute of the onunload event.
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closePopupTrack (elem)
{       
	try {
		<span class="comment">// define global vars als false if not set</span>
		<span class="reserved">if</span> (typeof audit == <span class="literal">'undefined'</span>) {
			audit = false;
		}
		<span class="reserved">if</span> (typeof submitted == <span class="literal">'undefined'</span>) {
			submitted = false;
		}
		<span class="reserved">if</span> (audit !== true &amp;&amp; submitted !== true) {
			self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;
			self.opener.alert(alertOnClosePopup);
			<span class="comment">// reset global vars</span>
			audit = false;
			submitted = false;
		}	
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Track the close of popups which contains href links as close action.
 * &lt;br /&gt;
 * We need a handling if the user do not close the popups with the
 * appropriate link. For example, the user could use
 * keyboard shortcuts or close the popup by mouse click on the
 * window interface close button (depends on operating system).
 * &lt;br /&gt;
 * So this function is added to the popups html body event &lt;em&gt;onunload&lt;/em&gt;.
 * There is a condition, that compares wether the control var
 * (&lt;em&gt;audit&lt;/em&gt;) are set (respectively are &lt;em&gt;bool&lt;/em&gt; true)
 * or not. On the basis of the result, we revoke the lowering of opacity in the parent window.
 * 
 * <span class="attrib">@param</span> {global} audit Defined in {<span class="attrib">@link</span> #closeLinksPopup}.
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_closePopupTrackNoAlert (elem)
{       
	try {
		<span class="comment">// define global vars als false if not set		</span>
		<span class="reserved">if</span> (typeof audit == <span class="literal">'undefined'</span>) {
			audit = false;
		}
		<span class="reserved">if</span> (audit !== true) {
			self.opener.$(<span class="literal">'lyLowerOpacity'</span>).style.display = <span class="literal">'none'</span>;
			<span class="comment">// reset global vars</span>
			audit = false;
		}	
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Lower opacity via DOM build Layer.
 * &lt;br /&gt;
 * Here we build a layer per DOM, which use a transparent PNG image.
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_lowerOpacity ()
{       
	try {
 		<span class="comment">// properties</span>
        <span class="reserved">this</span>.cLeft = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cTop = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cPosition = <span class="literal">'absolute'</span>;
        <span class="reserved">this</span>.cDisplay = <span class="literal">'block'</span>;
        <span class="reserved">this</span>.imagePath = <span class="literal">'../static/img/bg_overlay.png'</span>;
		<span class="reserved">this</span>.lyContainer = $(<span class="literal">'container'</span>);   
        <span class="reserved">this</span>.buildHeight = <span class="reserved">this</span>.lyContainer.offsetHeight;
        <span class="reserved">this</span>.buildWidth = <span class="reserved">this</span>.lyContainer.offsetWidth;
		<span class="reserved">this</span>.imageStr = <span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.imagePath + <span class="literal">'" width="'</span> + <span class="reserved">this</span>.buildWidth + <span class="literal">'" height="'</span> + <span class="reserved">this</span>.buildHeight +<span class="literal">'" alt="" /&gt;'</span>;
		<span class="reserved">this</span>.targetToLower = $(<span class="literal">'lyLowerOpacity'</span>);

        <span class="reserved">if</span> (<span class="reserved">this</span>.targetToLower) {
		 	<span class="reserved">this</span>.targetToLower.style.display = <span class="reserved">this</span>.cDisplay;
			<span class="reserved">this</span>.targetToLower.style.position = <span class="reserved">this</span>.cPosition;
			<span class="reserved">this</span>.targetToLower.style.top = <span class="reserved">this</span>.cTop;
			<span class="reserved">this</span>.targetToLower.style.left = <span class="reserved">this</span>.cLeft;
			<span class="reserved">this</span>.targetToLower.style.height = <span class="reserved">this</span>.buildHeight + <span class="literal">'px'</span>;
			<span class="reserved">this</span>.targetToLower.style.width = <span class="reserved">this</span>.buildWidth + <span class="literal">'px'</span>;
			
			Element.update(<span class="reserved">this</span>.targetToLower, <span class="reserved">this</span>.imageStr);
        }
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Lower opacity via DOM build Layer on load of page.
 * &lt;br /&gt;
 * Here we build a layer per DOM, which use a transparent PNG image.
 * Used within popups.
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_lowerOpacityOnUpload ()
{       
	try {
 		<span class="comment">// properties</span>
        <span class="reserved">this</span>.cLeft = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cTop = <span class="literal">'0px'</span>;
        <span class="reserved">this</span>.cPosition = <span class="literal">'absolute'</span>;
        <span class="reserved">this</span>.cDisplay = <span class="literal">'block'</span>;
        <span class="reserved">this</span>.imagePath = <span class="literal">'../static/img/bg_overlay.png'</span>;
		<span class="reserved">this</span>.lyContainer = $(<span class="literal">'modalWindow'</span>);   
        <span class="reserved">this</span>.buildHeight = <span class="reserved">this</span>.lyContainer.offsetHeight;
        <span class="reserved">this</span>.buildWidth = <span class="reserved">this</span>.lyContainer.offsetWidth;
		<span class="reserved">this</span>.imageStr = <span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.imagePath + <span class="literal">'" width="'</span> + <span class="reserved">this</span>.buildWidth + <span class="literal">'" height="'</span> + <span class="reserved">this</span>.buildHeight +<span class="literal">'" alt="" /&gt;'</span>;
		<span class="reserved">this</span>.target_toLower = $(<span class="literal">'lyLowerOpacity'</span>);

        <span class="reserved">if</span> (<span class="reserved">this</span>.targetToLower) {
		 	<span class="reserved">this</span>.targetToLower.style.display = <span class="reserved">this</span>.cDisplay;
			<span class="reserved">this</span>.targetToLower.style.position = <span class="reserved">this</span>.cPosition;
			<span class="reserved">this</span>.targetToLower.style.top = <span class="reserved">this</span>.cTop;
			<span class="reserved">this</span>.targetToLower.style.left = <span class="reserved">this</span>.cLeft;
			<span class="reserved">this</span>.targetToLower.style.height = <span class="reserved">this</span>.buildHeight + <span class="literal">'px'</span>;
			<span class="reserved">this</span>.targetToLower.style.width = <span class="reserved">this</span>.buildWidth + <span class="literal">'px'</span>;
				
			Element.update(<span class="reserved">this</span>.targetToLower, <span class="reserved">this</span>.imageStr);
        }
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * UNDER DEVELOPMENT
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_unsupportsEffects(exception)
{	
	try {
		<span class="comment">//properties</span>
		<span class="reserved">this</span>.browser = _setBrowserString();
		<span class="reserved">this</span>.version = _setBrowserStringVersion();
		<span class="reserved">this</span>.exception = exception;
			
		<span class="reserved">if</span> ((<span class="reserved">this</span>.browser == <span class="literal">"Internet Explorer"</span>) || (<span class="reserved">this</span>.browser == <span class="literal">"Safari"</span> &amp;&amp; !<span class="reserved">this</span>.exception)) {
			<span class="reserved">return</span> true;
		} <span class="reserved">else</span> { 
			<span class="reserved">return</span> false;
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * UNDER DEVELOPMENT
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_unsupportsElems(exception)
{	
	try {
		<span class="comment">//properties</span>
		<span class="reserved">this</span>.browser = _setBrowserString();
		<span class="reserved">this</span>.version = _setBrowserStringVersion();
		<span class="reserved">this</span>.exception = exception;
		
		<span class="reserved">if</span> ((<span class="reserved">this</span>.browser == <span class="literal">"Internet Explorer"</span>) || (<span class="reserved">this</span>.browser == <span class="literal">"Safari"</span> &amp;&amp; !<span class="reserved">this</span>.exception)) {
			<span class="reserved">return</span> true;
		} <span class="reserved">else</span> { 
			<span class="reserved">return</span> false;
		}
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * UNDER DEVELOPMENT
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _compare (string)
{
	try {
		res = detect.indexOf(string) + 1;
		thestring = string;
		<span class="reserved">return</span> res;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * UNDER DEVELOPMENT
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _setBrowserString ()
{
	try {			
		detect = navigator.userAgent.toLowerCase();
		var browser;

		<span class="reserved">if</span> (_compare(<span class="literal">'safari'</span>)) {
			browser = <span class="literal">'Safari'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (_compare(<span class="literal">'msie'</span>)) {
			browser = <span class="literal">'Internet Explorer'</span>;
		}
		<span class="reserved">else</span> {
			browser = <span class="literal">'Unknown Browser'</span>;
		}
		<span class="reserved">return</span> browser;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * UNDER DEVELOPMENT
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _setBrowserStringVersion ()
{
	try {			
		_setBrowserString();
		var version;
		
		version = detect.charAt(res + thestring.length);

		<span class="reserved">return</span> version;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * UNDER DEVELOPMENT
 * 
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> _setBrowserStringOS ()
{
	try {			
		detect = navigator.userAgent.toLowerCase();
		var os;
		
		<span class="reserved">if</span> (_compare(<span class="literal">'linux'</span>)) {
			os = <span class="literal">'Linux'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (_compare(<span class="literal">'x11'</span>)) {
			os = <span class="literal">'Unix'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (_compare(<span class="literal">'win'</span>)) {
			os = <span class="literal">'Windows'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (_compare(<span class="literal">'mac'</span>)) {
			os = <span class="literal">'Mac'</span>;
		}
		<span class="reserved">else</span> {
			os = <span class="literal">'Unknown operating system'</span>;
		}
		<span class="reserved">return</span> os;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Define and resize window width.
 * &lt;br /&gt;
 * Center the new window depending on giving Width.
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@param</span> {var} elemWidth Given width
 * <span class="attrib">@return</span> {number} x
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_defineWindowX (elemWidth)
{
	try {
		<span class="comment">//properties</span>
		<span class="reserved">this</span>.el = elemWidth;
		var x;
		
		<span class="reserved">if</span> (self.innerHeight) {
			<span class="comment">// all except Explorer {</span>
			x = Math.round(self.innerWidth) - (Math.round(<span class="reserved">this</span>.el));
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.clientHeight) {
			<span class="comment">// Explorer 6 Strict Mode</span>
			x = Math.round(document.documentElement.clientWidth) - (Math.round(<span class="reserved">this</span>.el));
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (document.body) {
			<span class="comment">// other Explorers</span>
			x = Math.round(document.body.clientWidth) - (Math.round(<span class="reserved">this</span>.el));
		}
		x = Math.round(x/2);
		<span class="reserved">return</span> x;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Define and resize window height.
 * &lt;br /&gt;
 * Center the new window depending on calculated height
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@throws</span> applyError on exception
 * <span class="attrib">@return</span> {number} y
 */</span>
<span class="reserved">function</span> Helper_defineWindowY ()
{
	try {
		<span class="comment">//properties</span>
		var y;
	
		<span class="reserved">if</span> (self.innerHeight) { 
		<span class="comment">// all except Explorer</span>
			y = Math.round(self.innerHeight/6);
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.clientHeight) {
			<span class="comment">// Explorer 6 Strict Mode</span>
			y = Math.round(document.documentElement.clientHeight/6);
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (document.body) {
			<span class="comment">// other Explorers</span>
			y = Math.round(document.body.clientHeight/6);
		}
		<span class="reserved">return</span> y;
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Show next appropriate DOM node.
 * &lt;br /&gt;
 * Used in internal links popups to reflect sitemap structure.
 * 
 * <span class="attrib">@see</span> #loaderPagesLinks
 * <span class="attrib">@see</span> #showResponsePagesSecondLinks
 * <span class="attrib">@see</span> #showResponsePagesThirdLinks
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showNextNode(elem)
{
	try {
		<span class="comment">// get source node id from element</span>
		var sourceNode = elem.parentNode.parentNode.parentNode.parentNode.parentNode;
		
		<span class="comment">// get next possible node id</span>
		<span class="reserved">if</span> (sourceNode.id != <span class="literal">'thirdNode'</span>) {
			var nextNode = Helper.getAttrNextSibling(<span class="literal">'id'</span>, sourceNode, 2);
		}

		var url = <span class="reserved">this</span>.parsePagesLinksUrl;
		var pars = <span class="literal">'id='</span> + elem.id +<span class="literal">'&amp;nextNode='</span> + nextNode + <span class="literal">'&amp;control='</span> + control;
		
		<span class="reserved">if</span> (nextNode == <span class="literal">'secondNode'</span>) {
		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				parameters : pars,
				onLoading : Helper.loaderPagesLinks,
				onComplete : Helper.showResponsePagesSecondLinks
			});
		}
		<span class="reserved">else</span> <span class="reserved">if</span> (nextNode == <span class="literal">'thirdNode'</span>) {
		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				parameters : pars,
				onLoading : Helper.loaderPagesLinks,
				onComplete : Helper.showResponsePagesThirdLinks
			});
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Display indicator while XMLHttpRequest processing.
 *
 * <span class="attrib">@see</span> #showNextNode
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_loaderPagesLinks ()
{
	try {
		Element.show(<span class="literal">'indicator_pagesLinks'</span>);
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Populate on XMLHttpRequest Response.
 *
 * <span class="attrib">@see</span> #showNextNode
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponsePagesSecondLinks(req)
{
	try {
		Effect.Fade(<span class="literal">'indicator_pagesLinks'</span>, {duration: 0.4});
		Effect.Appear(<span class="literal">'secondNode'</span>,{duration: 0.6});
		$(<span class="literal">'secondNode'</span>).innerHTML = req.responseText;		
		Behaviour.reapply(<span class="literal">'.act_setInternalLink'</span>);
		Behaviour.reapply(<span class="literal">'.act_setInternalLinkNoHref'</span>);
		Behaviour.reapply(<span class="literal">'.showNextNode'</span>);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Populate on XMLHttpRequest Response.
 *
 * <span class="attrib">@see</span> #showNextNode
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponsePagesThirdLinks(req)
{
	try {
		Effect.Fade(<span class="literal">'indicator_pagesLinks'</span>, {duration: 0.4});
		Effect.Appear(<span class="literal">'thirdNode'</span>,{duration: 0.6});	
		$(<span class="literal">'thirdNode'</span>).innerHTML = req.responseText;		
		Behaviour.reapply(<span class="literal">'.act_setInternalLink'</span>);
		Behaviour.reapply(<span class="literal">'.act_setInternalLinkNoHref'</span>);
		Behaviour.reapply(<span class="literal">'.showNextNode'</span>);
		
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process inserting content from a popup.
 * &lt;br /&gt;
 * Adapted from from http://sourceforge.net/projects/wikipedia
 * 
 * <span class="attrib">@see</span> #insertInternalLink
 * <span class="attrib">@see</span> #insertInternalLinkNoHref
 * <span class="attrib">@see</span> #insertInternalLinkGlobalTemplates
 * <span class="attrib">@see</span> #insertInternalLinkGlobalFiles
 * <span class="attrib">@param</span> {string} id Form element to populate
 * <span class="attrib">@param</span> {string} tagOpen Opening part of build string
 * <span class="attrib">@param</span> {string} tagClose Closing part of build string
 * <span class="attrib">@param</span> {string} sampleText Text to set, when we use tagOpen and tagClose
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertTagsFromPopup(id, tagOpen, tagClose, sampleText)
{
	try {
		<span class="comment">/*
		We have to distinguish here, because the IE6 seems to be too dumb to differ between elements
		which has the same value on different attributes (name, id)	
		So we serve IE by object forms[elements], while Mozilla be able to use 
		the standard (pointing the element by document.getElementById()
		*/</span>
	 	<span class="reserved">if</span> (Helper.unsupportsElems(<span class="literal">'safari_exception'</span>)) {
			var _form_name = id.replace(/(.+)(_.+$)/, <span class="literal">'$1'</span>);
			var txtarea = opener.document.forms[_form_name].elements[id];
		} <span class="reserved">else</span> {
			var txtarea = opener.$(id);
		}
		<span class="comment">// IE</span>
		<span class="reserved">if</span>(opener.document.selection) {
			var theSelection = opener.document.selection.createRange().text;
			<span class="reserved">if</span>(!theSelection) { theSelection=sampleText;}
			txtarea.focus();
			<span class="reserved">if</span>(theSelection.charAt(theSelection.length - 1) == <span class="literal">" "</span>){<span class="comment">// exclude ending space char, if any</span>
				theSelection = theSelection.substring(0, theSelection.length - 1);
				opener.document.selection.createRange().text = tagOpen + theSelection + tagClose + <span class="literal">" "</span>;
			} <span class="reserved">else</span> {
				opener.document.selection.createRange().text = tagOpen + theSelection + tagClose;
			}
		<span class="comment">// Mozilla -- disabled because it induces a scrolling bug which makes it virtually unusable</span>
		} <span class="reserved">else</span> <span class="reserved">if</span>(txtarea.selectionStart || txtarea.selectionStart == <span class="literal">'0'</span>) {
	 		var startPos = txtarea.selectionStart;
			var endPos = txtarea.selectionEnd;
			var scrollTop=txtarea.scrollTop;
			var myText = (txtarea.value).substring(startPos, endPos);
			<span class="reserved">if</span>(!myText) { myText=sampleText;}
			<span class="reserved">if</span>(myText.charAt(myText.length - 1) == <span class="literal">" "</span>){ <span class="comment">// exclude ending space char, if any</span>
				subst = tagOpen + myText.substring(0, (myText.length - 1)) + tagClose + <span class="literal">" "</span>; 
			} <span class="reserved">else</span> {
				subst = tagOpen + myText + tagClose; 
			}
			txtarea.value = txtarea.value.substring(0, startPos) + subst + txtarea.value.substring(endPos, txtarea.value.length);
			txtarea.focus();
			var cPos=startPos+(tagOpen.length+myText.length+tagClose.length);
			txtarea.selectionStart=cPos;
			txtarea.selectionEnd=cPos;
			txtarea.scrollTop=scrollTop;
		<span class="comment">// All others</span>
		} <span class="reserved">else</span> {
			<span class="comment">// Append at the end: Some people find that annoying</span>
			<span class="comment">//txtarea.value += tagOpen + sampleText + tagClose;</span>
			<span class="comment">//txtarea.focus();</span>
			var re=new RegExp(<span class="literal">"\\n"</span>,<span class="literal">"g"</span>);
			tagOpen=tagOpen.replace(re,<span class="literal">""</span>);
			tagClose=tagClose.replace(re,<span class="literal">""</span>);
			opener.document.infoform.infobox.value=tagOpen+sampleText+tagClose;
			txtarea.focus();
		}
		<span class="comment">// reposition cursor if possible</span>
		<span class="reserved">if</span> (txtarea.createTextRange) txtarea.caretPos = opener.document.selection.createRange().duplicate();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process inserting content.
 * &lt;br /&gt;
 * Adapted from from http://sourceforge.net/projects/wikipedia
 * 
 * <span class="attrib">@see</span> #insertInternalLink
 * <span class="attrib">@see</span> #insertInternalLinkNoHref
 * <span class="attrib">@see</span> #insertInternalLinkGlobalTemplates
 * <span class="attrib">@see</span> #insertInternalLinkGlobalFiles
 * <span class="attrib">@param</span> {string} id Form element to populate
 * <span class="attrib">@param</span> {string} tagOpen Opening part of build string
 * <span class="attrib">@param</span> {string} tagClose Closing part of build string
 * <span class="attrib">@param</span> {string} sampleText Text to set, when we use tagOpen and tagClose
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertTags(id, tagOpen, tagClose, sampleText)
{
	try {
		<span class="comment">/*
		We have to distinguish here, because the IE6 seems to be too dumb to differ between elements
		which has the same value on different attributes (name, id)	
		So we serve IE by object forms[elements], while Mozilla be able to use 
		the standard (pointing the element by document.getElementById()
		*/</span>
	 	<span class="reserved">if</span> (Helper.unsupportsElems(<span class="literal">'safari_exception'</span>)) {
			var _form_name = id.replace(/(.+)(_.+$)/, <span class="literal">'$1'</span>);
			var txtarea = document.forms[_form_name].elements[id];
		} <span class="reserved">else</span> {
			var txtarea = $(id);
		}
		<span class="comment">// IE</span>
		<span class="reserved">if</span>(document.selection) {
			var theSelection = document.selection.createRange().text;
			<span class="reserved">if</span>(!theSelection) { theSelection=sampleText;}
			txtarea.focus();
			<span class="reserved">if</span>(theSelection.charAt(theSelection.length - 1) == <span class="literal">" "</span>){<span class="comment">// exclude ending space char, if any</span>
				theSelection = theSelection.substring(0, theSelection.length - 1);
				document.selection.createRange().text = tagOpen + theSelection + tagClose + <span class="literal">" "</span>;
			} <span class="reserved">else</span> {
				document.selection.createRange().text = tagOpen + theSelection + tagClose;
			}
		<span class="comment">// Mozilla -- disabled because it induces a scrolling bug which makes it virtually unusable</span>
		} <span class="reserved">else</span> <span class="reserved">if</span>(txtarea.selectionStart || txtarea.selectionStart == <span class="literal">'0'</span>) {
	 		var startPos = txtarea.selectionStart;
			var endPos = txtarea.selectionEnd;
			var scrollTop=txtarea.scrollTop;
			var myText = (txtarea.value).substring(startPos, endPos);
			<span class="reserved">if</span>(!myText) { myText=sampleText;}
			<span class="reserved">if</span>(myText.charAt(myText.length - 1) == <span class="literal">" "</span>){ <span class="comment">// exclude ending space char, if any</span>
				subst = tagOpen + myText.substring(0, (myText.length - 1)) + tagClose + <span class="literal">" "</span>; 
			} <span class="reserved">else</span> {
				subst = tagOpen + myText + tagClose; 
			}
			txtarea.value = txtarea.value.substring(0, startPos) + subst + txtarea.value.substring(endPos, txtarea.value.length);
			txtarea.focus();
			var cPos=startPos+(tagOpen.length+myText.length+tagClose.length);
			txtarea.selectionStart=cPos;
			txtarea.selectionEnd=cPos;
			txtarea.scrollTop=scrollTop;
		<span class="comment">// All others</span>
		} <span class="reserved">else</span> {
			<span class="comment">// Append at the end: Some people find that annoying</span>
			<span class="comment">//txtarea.value += tagOpen + sampleText + tagClose;</span>
			<span class="comment">//txtarea.focus();</span>
			var re=new RegExp(<span class="literal">"\\n"</span>,<span class="literal">"g"</span>);
			tagOpen=tagOpen.replace(re,<span class="literal">""</span>);
			tagClose=tagClose.replace(re,<span class="literal">""</span>);
			document.infoform.infobox.value=tagOpen+sampleText+tagClose;
			txtarea.focus();
		}
		<span class="comment">// reposition cursor if possible</span>
		<span class="reserved">if</span> (txtarea.createTextRange) txtarea.caretPos = document.selection.createRange().duplicate();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Insert internal page links reference into content.
 * &lt;br /&gt;
 * We build a string with required syntax to deliver it to {<span class="attrib">@link</span> #insertTagsFromPopup}
 * and close the popup window afterwards.
 * 
 * <span class="attrib">@see</span> #insertTagsFromPopup
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertInternalLink(elem)
{
	try {
		var build;
		build = <span class="literal">'&lt;a href="'</span>;
		build += elem.id;
		build += <span class="literal">'"&gt;'</span>;
		
		strStart = build;
		strEnd = <span class="literal">'&lt;/a&gt;'</span>;
		
		Helper.insertTagsFromPopup(formTarget, strStart, strEnd, describeLink);
	
		Helper.closeLinksPopup();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Insert internal page links reference into content.
 * &lt;br /&gt;
 * Get the element id content, deliver it to {<span class="attrib">@link</span> #insertTagsFromPopup}
 * and close the popup window afterwards.
 * var &lt;em&gt;formTarget&lt;/em&gt; comes from the html markup.
 * 
 * <span class="attrib">@see</span> #insertTagsFromPopup
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertInternalLinkNoHref(elem)
{
	try {
		Helper.insertTagsFromPopup(formTarget, elem.id, <span class="literal">''</span>, <span class="literal">''</span>);
		Helper.closeLinksPopup();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Insert internal globaltemplates links reference into content.
 * &lt;br /&gt;
 * Get the element id content, deliver it to {<span class="attrib">@link</span> #insertTagsFromPopup}
 * and close the popup window afterwards.
 * var &lt;em&gt;formTarget&lt;/em&gt; comes from the html markup.
 * 
 * <span class="attrib">@see</span> #insertTagsFromPopup
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertInternalLinkGlobalTemplates(elem)
{
	try {
		Helper.insertTagsFromPopup(formTarget, elem.id, <span class="literal">''</span>, <span class="literal">''</span>);	
		Helper.closeLinksPopup();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Insert internal globalfiles links reference into content.
 * &lt;br /&gt;
 * Get the element id content, deliver it to {<span class="attrib">@link</span> #insertTagsFromPopup}
 * and close the popup window afterwards.
 * var &lt;em&gt;formTarget&lt;/em&gt; comes from the html markup.
 * 
 * <span class="attrib">@see</span> #insertTagsFromPopup
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertInternalLinkGlobalFiles(elem)
{
	try {
		Helper.insertTagsFromPopup(formTarget, elem.id, <span class="literal">''</span>, <span class="literal">''</span>);
		Helper.closeLinksPopup();
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get internal structure templates reference.
 * &lt;br /&gt;
 * Get the appropriate content and populate it unseen into a special,
 * original tag (see {<span class="attrib">@link</span> #showResponseStructuralTemplates}) within
 * the html markup.
 * 
 * <span class="attrib">@see</span> #showResponseStructuralTemplates
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_insertInternalLinkStructuralTemplates(elem)
{
	try {		
		var url = <span class="reserved">this</span>.parseStructuralTemplatesLinksUrl;
		var pars = <span class="literal">'id='</span> + elem.id;

		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				parameters : pars,
				onComplete : Helper.showResponseStructuralTemplates
			});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Process and insert XMLHttpRequest response into content.
 * &lt;br /&gt;
 * First we fetch the response with the surrounding html comment tag.
 * This is because we are working with markup, so this has to be distinctive.
 * Then we extract the proper content, deliver it to {<span class="attrib">@link</span> #insertTagsFromPopup}
 * and close the popup window afterwards.
 * var &lt;em&gt;formTarget&lt;/em&gt; comes from the html markup.
 *
 * <span class="attrib">@see</span> #insertInternalLinkStructuralTemplates
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponseStructuralTemplates(req)
{
	try {		
		<span class="comment">// filter responseText on html element</span>
		var extract = req.responseText.match(/(&lt;!--\s+&lt;span id=<span class="literal">"template_content"</span>&gt;)((.|\t|\r|\n)*)(&lt;\/span&gt;\s+\/\/--&gt;)/gm);
		
		<span class="comment">// strip the html element, get raw content</span>
		var raw_content = String(extract).replace(/(.*?)(&gt;)((.|\t|\r|\n)*)(&lt;\/span&gt;\s+\/\/--&gt;)/, <span class="literal">"$3"</span>);
		
		Helper.insertTagsFromPopup(formTarget, raw_content, <span class="literal">''</span>, <span class="literal">''</span>);
		Helper.closeLinksPopup();					
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Change blog comment status.
 * &lt;br/&gt;
 * Get the form select values with corresponding comment id
 * and edit on page.
 * 
 * <span class="attrib">@see</span> #loaderChangeBlogCommentStatus
 * <span class="attrib">@see</span> #showResponseChangeBlogCommentStatus
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_changeBlogCommentStatus (elem)
{	
	try {
		var statusId;
		var commentId;
		
		<span class="comment">// get status value</span>
		statusId = elem.options[elem.selectedIndex].value;
	
		<span class="comment">// find blog comment id</span>
		commentId = elem.parentNode.parentNode.parentNode;
		commentId = Helper.getNextSiblingFirstChild(commentId, 4);
		commentId = String(commentId.href);
		commentId = commentId.replace(/(.*?)(id\=+)(\d+)/g, <span class="literal">"$3"</span>);		

		<span class="comment">// properties</span>
		var url = <span class="reserved">this</span>.parseBlogCommmentStatusChangeUrl;
		var pars = <span class="literal">'status_id='</span> + statusId + <span class="literal">'&amp;comment_id='</span> + commentId;

		var myAjax = new Ajax.Request(
			url,
			{
				method : <span class="literal">'get'</span>,
				onLoading : Helper.loaderChangeBlogCommentStatus,
				parameters : pars,
				onComplete : Helper.showResponseChangeBlogCommentStatus
			});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Display indicator layer while XMLHttpRequest processing.
 * Trigger {<span class="attrib">@link</span> #lowerOpacity}.
 *
 * <span class="attrib">@see</span> #lowerOpacity
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_loaderChangeBlogCommentStatus ()
{
	try {
		Helper.lowerOpacity();
		Effect.Appear(<span class="literal">'statuschange'</span>, {duration: 0.6, delay: 0.2});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Layer fadeout on XMLHttpRequest response.
 *
 * <span class="attrib">@see</span> #changeBlogCommentStatus
 * <span class="attrib">@param</span> {object} req XMLHttpRequest response
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showResponseChangeBlogCommentStatus(req)
{
	try {
		setTimeout(<span class="literal">"Effect.Fade('statuschange', {duration: 0.6})"</span>, 2000);
		setTimeout(<span class="literal">"$('lyLowerOpacity').style.display = 'none';"</span>, 2800);
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Display upload indicator.
 * Trigger {<span class="attrib">@link</span> #lowerOpacityOnUpload}. This is used on submit
 * within the media upload popup to indicate the upload still remains.
 *
 * <span class="attrib">@see</span> #lowerOpacityOnUpload
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_showFileUploadMessage()
{
	try {
		Helper.lowerOpacityOnUpload();
		Effect.Appear(<span class="literal">'uploadMessage'</span>, {duration: 0.4});
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Validate form elements on the fly.
 * &lt;br /&gt;
 * Get the form element id attribute value and populate the
 * regex processed response into the layer &lt;em&gt;container&lt;/em&gt;.
 * This assumes that we have corresponding html markup/css.
 * &lt;br /&gt;
 * For in depths explanation please have a look on the online
 * project support area.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_validate(elem)
{	
	var url		= <span class="reserved">this</span>.validateUrl;
	elemID		= $(elem).getAttribute(<span class="literal">'id'</span>);
	var elemVal	= $F(elem);
	var pars	= <span class="literal">'elemID='</span> + elemID + <span class="literal">'&amp;elemVal='</span> + elemVal;
	var container = elemID + <span class="literal">'_container'</span>;
	
	var myAjax = new Ajax.Updater ( 
		{
			failure: container,
			success: container
		},
		url,
		{
			method: <span class="literal">'post'</span>,
			parameters: pars
		});		
}

<span class="comment">/**
 * Confirm navigation delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelNavAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelNav);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm template type delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplTypeAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplType);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm template sets delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplSetsAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplSets);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm global template delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplGlobalAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplGlobal);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Confirm global file delete.
 * 
 * <span class="attrib">@param</span> {var} elem Current element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_confirmDelTplGlobalfileAction(elem)
{
	try {	
		var v = confirm(confirmMsgDelTplGlobalfile);

		<span class="reserved">if</span> (v == true) {
			window.location.href = elem.href;
		}
	} catch (e) {
		_applyError(e);
	}	
}

<span class="comment">/**
 * Change delimiter on given form value.
 * &lt;br /&gt;
 * In some cases it is required to change the delimiter to avoid syntax
 * conflicts while inserting references (e.g. working with cascading
 * style sheets or javascript, which uses brackets also).
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getDelimiterValue()
{
	try {
		<span class="reserved">if</span> ($(<span class="literal">'global_template_change_delimiter'</span>)) {
			delimiter = $F(<span class="literal">'global_template_change_delimiter'</span>);
		} <span class="reserved">else</span> {
			delimiter = <span class="literal">''</span>;
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Get the current pager_page value.
 * &lt;br /&gt;
 * This is needed for Media Manager action popups (&lt;em&gt;upload&lt;/em&gt;, &lt;em&gt;edit&lt;/em&gt;)
 * which supposed to refresh the content display on close of popup.
 * 
 * <span class="attrib">@see</span> #launchPopup
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getPagerPage()
{
	try {
		<span class="reserved">if</span>($(<span class="literal">'pager_page_container'</span>)) {
			pager_page = $(<span class="literal">'pager_page_container'</span>).firstChild.nodeValue;
		} <span class="reserved">else</span> {
			pager_page = <span class="literal">''</span>;
		}
	} catch (e) {
		_applyError(e);
	}
}

<span class="comment">/**
 * Getter for  parent node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Parent node attribute of element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttrParentNode (attr, elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.parentNode;
	}
		
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'Internet Explorer'</span>)
		<span class="reserved">return</span> a.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> a.getAttribute(attr);
}

<span class="comment">/**
 * Getter for node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@return</span> object Attribute of element
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttr (attr, elem)
{
	<span class="reserved">this</span>.browser = _setBrowserString();
		
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'Internet Explorer'</span>)
		<span class="reserved">return</span> elem.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> elem.getAttribute(attr);
}


<span class="comment">/**
 * Getter for next sibling node attribute.
 *
 * <span class="attrib">@param</span> {string} attr Given attribute to use
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Next sibling attribute
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getAttrNextSibling (attr, elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();
	
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'Internet Explorer'</span>)
		level-- ;

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.nextSibling;
	}
		
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'Internet Explorer'</span>)
		<span class="reserved">return</span> a.attributes[attr].value;
	<span class="reserved">else</span>
		<span class="reserved">return</span> a.getAttribute(attr);
}

<span class="comment">/**
 * Getter for next sibling first child node attribute.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Next sibling first child value
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getNextSiblingFirstChild (elem, level)
{
	<span class="reserved">this</span>.browser = _setBrowserString();
	
	<span class="reserved">if</span> (<span class="reserved">this</span>.browser == <span class="literal">'Internet Explorer'</span> || <span class="reserved">this</span>.browser == <span class="literal">'Safari'</span>)
		level-- ;

	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.nextSibling;
	}
	<span class="reserved">return</span> a.firstChild;
}

<span class="comment">/**
 * Getter for parent node data.
 *
 * <span class="attrib">@param</span> {object} elem Current element
 * <span class="attrib">@param</span> {string} level Depth of parent node search
 * <span class="attrib">@return</span> object Parent node data
 * <span class="attrib">@throws</span> applyError on exception
 */</span>
<span class="reserved">function</span> Helper_getDataParentNode (elem, level)
{
	<span class="reserved">for</span> (var a = elem; level &gt; 0; level--) {
		a = a.parentNode;
	}
	<span class="reserved">return</span> Helper.trim(a.firstChild.nodeValue.toLowerCase());	
}

<span class="comment">/**
 * Building new object instance of class Helper
 */</span>
Helper = new Helper();
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>Welcompose Publishing System</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Wed Dec 13 12:06:32 2006</div>
</body>
</html>
